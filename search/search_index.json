{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Syscheck - OVerview \u00b6 Changes \u00b6 Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates","title":"Home"},{"location":"#syscheck-overview","text":"","title":"Syscheck - OVerview"},{"location":"#changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates","title":"Changes"},{"location":"ansible/","text":"Syscheck config management via ansible \u00b6 Changes \u00b6 Version Author Date Comment 1.0 Henrik Andreasson 2020-11-01 Initial version Configuration Management - ansible \u00b6 syscheck is configurable with ansible. configure \u00b6 Look at misc/ansible/roles/defaults/main.yml for variables you\u2019d like to customize Then enter them into host_vars or group_vars running \u00b6 put every ting in /misc/ansible or another directory of your choosing ansible-playbook -i /misc/ansible/hosts --limit=host.srv.domain.com -vv /misc/ansible/playbook-syscheck --user username --ask-become --become --become-method=su --private-key =/home/user/.ssh/id_rsa \u2013connection=ssh","title":"Syscheck config management via ansible"},{"location":"ansible/#syscheck-config-management-via-ansible","text":"","title":"Syscheck config management via ansible"},{"location":"ansible/#changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2020-11-01 Initial version","title":"Changes"},{"location":"ansible/#configuration-management-ansible","text":"syscheck is configurable with ansible.","title":"Configuration Management - ansible"},{"location":"ansible/#configure","text":"Look at misc/ansible/roles/defaults/main.yml for variables you\u2019d like to customize Then enter them into host_vars or group_vars","title":"configure"},{"location":"ansible/#running","text":"put every ting in /misc/ansible or another directory of your choosing ansible-playbook -i /misc/ansible/hosts --limit=host.srv.domain.com -vv /misc/ansible/playbook-syscheck --user username --ask-become --become --become-method=su --private-key =/home/user/.ssh/id_rsa \u2013connection=ssh","title":"running"},{"location":"backup-management/","text":"\ufeffSyscheck backup management \u00b6 Changes \u00b6 Version Author Date Comment 1.0 Henrik Andreasson 2010-10-12 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates Introduction \u00b6 Syscheck has the possibility to backup the database to a file in several different locations, these can be used to save hourly, daily, monthly and yearly backups in different locations and save those in different amount of times. Default values of saving the different backups can be adjusted in the config file for \u201cclean old backups script\u201d ( /config/908.config) Syscheck backup management \u00b6 Syscheck has the possibility to backup the database to a file in several different locations, these can be used to save hourly, daily, monthly and yearly backups in different locations and save those in different amount of times. Default values of saving the different backups can be adjusted in the config file for \u201cclean old backups script\u201d ( /config/908.config) Add the different backups to crontab \u00b6 $ sudo crontab -e # hourly backups at 10 mins past every hour 10 * * * * /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh # daily backups 03:10 10 3 * * * /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh --daily # weekly backups on sundays 03:20 20 3 * * 7 /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh --weekly # monthly backups on first day of month 3:30 30 3 1 * * /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh --monthly # yearly backup on first of januari 3:40 40 3 1 1 * /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh --yearly Make new backup dirs \u00b6 # mkdir -p /backup/mysql/default # mkdir -p /backup/mysql/daily # mkdir -p /backup/mysql/weekly # mkdir -p /backup/mysql/monthly # mkdir -p /backup/mysql/yearly run backup \u00b6 [root@ca1 related-enabled]# /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh -s I-90401-LAB 20200519 15:11:35 ca1.lab.certificateservices.se: INFO - mysqlbackup Backed up db ok file: /backup/mysql//default/mysql-2020-05-19_15.11.33.gz time to complete(sec): 2 filesize(b I-90401-LAB 20200519 15:11:36 ca1.lab.certificateservices.se: INFO - mysqlbackup Backed up db ok file: /backup/mysql//default/ejbca-2020-05-19_15.11.35.gz time to complete(sec): 1 filesize(b Enable the clean old backups script \u00b6 cd /opt/syscheck/related-enabled/ syscheck/related-enabled# ln -s ../related-available/908_clean_old_backups.sh . Verify the config file \u00b6 $ sudo vi /opt/syscheck/config/908.config ### config for 908_clean_old_backups.sh KEEPDAYS[0]=10; BACKUPDIR[0]=\"/backup/mysql/default/\"; DATESTR[0]=` ${ SYSCHECK_HOME } /lib/x-days-ago-datestring.pl ${ KEEPDAYS [ 0 ] } 2>/dev/null`; FILENAME[0]=\" ${ BACKUPDIR [ 0 ] } /ejbcabackup- ${ DATESTR [ 0 ] } *\" KEEPDAYS[1]=30; BACKUPDIR[1]=\"/backup/mysql/daily\"; DATESTR[1]=` ${ SYSCHECK_HOME } /lib/x-days-ago-datestring.pl ${ KEEPDAYS [ 0 ] } 2>/dev/null`; FILENAME[1]=\" ${ BACKUPDIR [ 0 ] } /ejbcabackup- ${ DATESTR [ 0 ] } *\" KEEPDAYS[2]=90; BACKUPDIR[2]=\"/backup/mysql/weekly/\"; DATESTR[2]=` ${ SYSCHECK_HOME } /lib/x-days-ago-datestring.pl ${ KEEPDAYS [ 1 ] } 2>/dev/null`; FILENAME[2]=\" ${ BACKUPDIR [ 1 ] } /ejbcabackup- ${ DATESTR [ 1 ] } *\" KEEPDAYS[3]=370; BACKUPDIR[3]=\"/backup/mysql/monthly/\"; DATESTR[3]=` ${ SYSCHECK_HOME } /lib/x-days-ago-datestring.pl ${ KEEPDAYS [ 1 ] } 2>/dev/null`; FILENAME[3]=\" ${ BACKUPDIR [ 1 ] } /ejbcabackup- ${ DATESTR [ 1 ] } *\" Add clean old backups to crontab \u00b6 $ sudo crontab -e # at 4:10 am each day clean old backups 10 4 * * * /opt/syscheck/related-enabled/908_clean_old_backups.sh","title":"\ufeffSyscheck backup management"},{"location":"backup-management/#syscheck-backup-management","text":"","title":"\ufeffSyscheck backup management"},{"location":"backup-management/#changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2010-10-12 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates","title":"Changes"},{"location":"backup-management/#introduction","text":"Syscheck has the possibility to backup the database to a file in several different locations, these can be used to save hourly, daily, monthly and yearly backups in different locations and save those in different amount of times. Default values of saving the different backups can be adjusted in the config file for \u201cclean old backups script\u201d ( /config/908.config)","title":"Introduction"},{"location":"backup-management/#syscheck-backup-management_1","text":"Syscheck has the possibility to backup the database to a file in several different locations, these can be used to save hourly, daily, monthly and yearly backups in different locations and save those in different amount of times. Default values of saving the different backups can be adjusted in the config file for \u201cclean old backups script\u201d ( /config/908.config)","title":"Syscheck backup management"},{"location":"backup-management/#add-the-different-backups-to-crontab","text":"$ sudo crontab -e # hourly backups at 10 mins past every hour 10 * * * * /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh # daily backups 03:10 10 3 * * * /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh --daily # weekly backups on sundays 03:20 20 3 * * 7 /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh --weekly # monthly backups on first day of month 3:30 30 3 1 * * /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh --monthly # yearly backup on first of januari 3:40 40 3 1 1 * /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh --yearly","title":"Add the different backups to crontab"},{"location":"backup-management/#make-new-backup-dirs","text":"# mkdir -p /backup/mysql/default # mkdir -p /backup/mysql/daily # mkdir -p /backup/mysql/weekly # mkdir -p /backup/mysql/monthly # mkdir -p /backup/mysql/yearly","title":"Make new backup dirs"},{"location":"backup-management/#run-backup","text":"[root@ca1 related-enabled]# /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh -s I-90401-LAB 20200519 15:11:35 ca1.lab.certificateservices.se: INFO - mysqlbackup Backed up db ok file: /backup/mysql//default/mysql-2020-05-19_15.11.33.gz time to complete(sec): 2 filesize(b I-90401-LAB 20200519 15:11:36 ca1.lab.certificateservices.se: INFO - mysqlbackup Backed up db ok file: /backup/mysql//default/ejbca-2020-05-19_15.11.35.gz time to complete(sec): 1 filesize(b","title":"run backup"},{"location":"backup-management/#enable-the-clean-old-backups-script","text":"cd /opt/syscheck/related-enabled/ syscheck/related-enabled# ln -s ../related-available/908_clean_old_backups.sh .","title":"Enable the clean old backups script"},{"location":"backup-management/#verify-the-config-file","text":"$ sudo vi /opt/syscheck/config/908.config ### config for 908_clean_old_backups.sh KEEPDAYS[0]=10; BACKUPDIR[0]=\"/backup/mysql/default/\"; DATESTR[0]=` ${ SYSCHECK_HOME } /lib/x-days-ago-datestring.pl ${ KEEPDAYS [ 0 ] } 2>/dev/null`; FILENAME[0]=\" ${ BACKUPDIR [ 0 ] } /ejbcabackup- ${ DATESTR [ 0 ] } *\" KEEPDAYS[1]=30; BACKUPDIR[1]=\"/backup/mysql/daily\"; DATESTR[1]=` ${ SYSCHECK_HOME } /lib/x-days-ago-datestring.pl ${ KEEPDAYS [ 0 ] } 2>/dev/null`; FILENAME[1]=\" ${ BACKUPDIR [ 0 ] } /ejbcabackup- ${ DATESTR [ 0 ] } *\" KEEPDAYS[2]=90; BACKUPDIR[2]=\"/backup/mysql/weekly/\"; DATESTR[2]=` ${ SYSCHECK_HOME } /lib/x-days-ago-datestring.pl ${ KEEPDAYS [ 1 ] } 2>/dev/null`; FILENAME[2]=\" ${ BACKUPDIR [ 1 ] } /ejbcabackup- ${ DATESTR [ 1 ] } *\" KEEPDAYS[3]=370; BACKUPDIR[3]=\"/backup/mysql/monthly/\"; DATESTR[3]=` ${ SYSCHECK_HOME } /lib/x-days-ago-datestring.pl ${ KEEPDAYS [ 1 ] } 2>/dev/null`; FILENAME[3]=\" ${ BACKUPDIR [ 1 ] } /ejbcabackup- ${ DATESTR [ 1 ] } *\"","title":"Verify the config file"},{"location":"backup-management/#add-clean-old-backups-to-crontab","text":"$ sudo crontab -e # at 4:10 am each day clean old backups 10 4 * * * /opt/syscheck/related-enabled/908_clean_old_backups.sh","title":"Add clean old backups to crontab"},{"location":"certificate_and_revovation_archival/","text":"Certificate and revocation Archival \u00b6 Changes \u00b6 Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates Intro \u00b6 From syscheck 1.2 and on there is a script-based archival solution. New and revoked certificates are stored on local disk in a file-tree and optional remote SSH server. Setup of syscheck \u00b6 First we need to configure 917_archive_file.sh that is a general archiving script. Do that by edit /conf/917.conf, make the directories \u201cInTransitDir\u201d and \u201cArchiveDir\u201d. Also make sure that users of 917_archive_file.sh can write to those directories. InTransitDir will be used as a temporary location when transferring files to remote hosts. ArchiveDir is the final destination on localhost. # config for 917_archive_file.sh InTransitDir=/misc/cert-archive/intransit ArchiveDir=/misc/cert-archive/archive #OUTFILE=\" ${ OUTPATH2 } /archived-crl- ${ DATE } - ${ CRLLASTUPDATE2 } - ${ CRLISSUER2 } \" OUTFILE=\" ${ OUTPATH2 } / ${ CRLISSUER2 } \" Now we\u2019ll configure the destinations for cert-, crl- and revocationarchiving. Edit /config/900.conf with your destinations. # config for related-available/900_export_cert.sh ### config ### OUTPATH =/ misc / cert - archive / local CERTLOG =$ { OUTPATH } / exportcert . log DATE = ` date + '%Y-%m- %d _%H.%m.%S' ` DATE2 = ` date + '%Y/%m/ %d ' ` OUTPATH2 = \"${OUTPATH}/${DATE2}\" # If you configure one or more REMOTE_HOST:s the archived certificate will also be stored on that host REMOTE_HOST [ 0 ] = \"192.168.158.131\" REMOTE_USER [ 0 ] = 'htmf' REMOTE_DIR [ 0 ] = '/misc/cert-archive/' SSHKEY [ 0 ] = '/home/han/.ssh/id_rsa' REMOTE_HOST [ 1 ] = \"127.0.0.1\" REMOTE_USER [ 1 ] = 'han' REMOTE_DIR [ 1 ] = '/misc/cert-archive/' SSHKEY [ 1 ] = '/home/han/.ssh/id_rsa' ### end config ### You can add more destinations just copy the config block and add \u201c1\u201d to the config index. Like this: REMOTE_HOST[2]=\"127.0.0.1\" REMOTE_USER[2]='han' REMOTE_DIR[2]='/misc/cert-archive/' SSHKEY[2]='/home/han/.ssh/id_rsa' Do the same with < syscheck >/ config / 901. conf ( config for 901 _export_revocation . sh ) and < syscheck >/ config / 902. conf ( config for 902 _export_crl . sh ) Setup of publisher \u00b6 Go to: EJBCA Adminweb \u2192 \u201dEdit Publishers\u201d \u2192 Add new name: \u201dArchival publisher\u201d Select/ enter the following: Publisher Type: \u201dCustom Publisher\u201d Class Path: \u201dorg.ejbca.core.model.ca.publisher.GeneralPurposeCustomPublisher\u201d Properties of Custom Publisher: crl . application / path / to / syscheck / related - enabled / 902 _export_crl . sh crl . failOnStandardError true crl . failOnErrorCode true cert . application / path / to / syscheck / related - enabled / 900 _export_cert . sh cert . failOnStandardError true cert . failOnErrorCode true revoke . application / path / to / syscheck / related - enabled / 901 _export_revocation . sh revoke . failOnStandardError true revoke . failOnErrorCode true Use the publisher on CA:s Go to: EJBCA Adminweb \u2192 \u201dEdit Certificate Authorites\u201d Select the CA you want CRL archival on, then click on edit CA At \u201dCRL Publishers\u201d: Select \u201dArchival publisher\u201d Do this for all CA:s you want CRL Archival for. Use the publisher on Certificate profile:s Go to: EJBCA Adminweb \u2192 \u201dEdit Certifcate Profiles\u201d At: \u201dPublishers\u201d Select \u201dArchival publisher\u201d Do this for all Certificate profiles:s you want Certifcate Archival for.","title":"Archiving"},{"location":"certificate_and_revovation_archival/#certificate-and-revocation-archival","text":"","title":"Certificate and revocation Archival"},{"location":"certificate_and_revovation_archival/#changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates","title":"Changes"},{"location":"certificate_and_revovation_archival/#intro","text":"From syscheck 1.2 and on there is a script-based archival solution. New and revoked certificates are stored on local disk in a file-tree and optional remote SSH server.","title":"Intro"},{"location":"certificate_and_revovation_archival/#setup-of-syscheck","text":"First we need to configure 917_archive_file.sh that is a general archiving script. Do that by edit /conf/917.conf, make the directories \u201cInTransitDir\u201d and \u201cArchiveDir\u201d. Also make sure that users of 917_archive_file.sh can write to those directories. InTransitDir will be used as a temporary location when transferring files to remote hosts. ArchiveDir is the final destination on localhost. # config for 917_archive_file.sh InTransitDir=/misc/cert-archive/intransit ArchiveDir=/misc/cert-archive/archive #OUTFILE=\" ${ OUTPATH2 } /archived-crl- ${ DATE } - ${ CRLLASTUPDATE2 } - ${ CRLISSUER2 } \" OUTFILE=\" ${ OUTPATH2 } / ${ CRLISSUER2 } \" Now we\u2019ll configure the destinations for cert-, crl- and revocationarchiving. Edit /config/900.conf with your destinations. # config for related-available/900_export_cert.sh ### config ### OUTPATH =/ misc / cert - archive / local CERTLOG =$ { OUTPATH } / exportcert . log DATE = ` date + '%Y-%m- %d _%H.%m.%S' ` DATE2 = ` date + '%Y/%m/ %d ' ` OUTPATH2 = \"${OUTPATH}/${DATE2}\" # If you configure one or more REMOTE_HOST:s the archived certificate will also be stored on that host REMOTE_HOST [ 0 ] = \"192.168.158.131\" REMOTE_USER [ 0 ] = 'htmf' REMOTE_DIR [ 0 ] = '/misc/cert-archive/' SSHKEY [ 0 ] = '/home/han/.ssh/id_rsa' REMOTE_HOST [ 1 ] = \"127.0.0.1\" REMOTE_USER [ 1 ] = 'han' REMOTE_DIR [ 1 ] = '/misc/cert-archive/' SSHKEY [ 1 ] = '/home/han/.ssh/id_rsa' ### end config ### You can add more destinations just copy the config block and add \u201c1\u201d to the config index. Like this: REMOTE_HOST[2]=\"127.0.0.1\" REMOTE_USER[2]='han' REMOTE_DIR[2]='/misc/cert-archive/' SSHKEY[2]='/home/han/.ssh/id_rsa' Do the same with < syscheck >/ config / 901. conf ( config for 901 _export_revocation . sh ) and < syscheck >/ config / 902. conf ( config for 902 _export_crl . sh )","title":"Setup of syscheck"},{"location":"certificate_and_revovation_archival/#setup-of-publisher","text":"Go to: EJBCA Adminweb \u2192 \u201dEdit Publishers\u201d \u2192 Add new name: \u201dArchival publisher\u201d Select/ enter the following: Publisher Type: \u201dCustom Publisher\u201d Class Path: \u201dorg.ejbca.core.model.ca.publisher.GeneralPurposeCustomPublisher\u201d Properties of Custom Publisher: crl . application / path / to / syscheck / related - enabled / 902 _export_crl . sh crl . failOnStandardError true crl . failOnErrorCode true cert . application / path / to / syscheck / related - enabled / 900 _export_cert . sh cert . failOnStandardError true cert . failOnErrorCode true revoke . application / path / to / syscheck / related - enabled / 901 _export_revocation . sh revoke . failOnStandardError true revoke . failOnErrorCode true Use the publisher on CA:s Go to: EJBCA Adminweb \u2192 \u201dEdit Certificate Authorites\u201d Select the CA you want CRL archival on, then click on edit CA At \u201dCRL Publishers\u201d: Select \u201dArchival publisher\u201d Do this for all CA:s you want CRL Archival for. Use the publisher on Certificate profile:s Go to: EJBCA Adminweb \u2192 \u201dEdit Certifcate Profiles\u201d At: \u201dPublishers\u201d Select \u201dArchival publisher\u201d Do this for all Certificate profiles:s you want Certifcate Archival for.","title":"Setup of publisher"},{"location":"cmp_dates/","text":"Syscheck - Syscheck component cmp_dates.py \u00b6 Changes \u00b6 Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 translate tool to pyton + mkdocs updates Intro \u00b6 usage : Util to check validity , compares two date strings and calculate the time left . Calculates also two limits WARN ( 1 /2 of the CRL lifetime), ERROR( 1/ 4 left of the lifetime ). The process returns with these values 0 -> ok , 1 -> warn , 2 -> error , 3 -> expired . [- h ] [-- warnminutes WARNMINUTES ] [-- errorminutes ERRORMINUTES ] [-- minutes ] [-- diff ] [-- noyearnotz ] [-- verbose ] date1 date2 positional arguments : date1 date1 ex : \"Mar 18 11:30:38 2017 GMT\" date2 date2 ex : \"Mar 18 19:30:38 2017 GMT\" optional arguments : - h , -- help show this help message and exit -- warnminutes WARNMINUTES set custom level for warning in minutes -- errorminutes ERRORMINUTES set custom level for error in minutes -- minutes just return minutes to warn -- diff just return minutes between the dates -- noyearnotz datetime without year and tz ( aka syslog format ) ex : Jul 27 11 : 36 : 54 -- verbose","title":"Util cmpdates"},{"location":"cmp_dates/#syscheck-syscheck-component-cmp_datespy","text":"","title":"Syscheck - Syscheck component cmp_dates.py"},{"location":"cmp_dates/#changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 translate tool to pyton + mkdocs updates","title":"Changes"},{"location":"cmp_dates/#intro","text":"usage : Util to check validity , compares two date strings and calculate the time left . Calculates also two limits WARN ( 1 /2 of the CRL lifetime), ERROR( 1/ 4 left of the lifetime ). The process returns with these values 0 -> ok , 1 -> warn , 2 -> error , 3 -> expired . [- h ] [-- warnminutes WARNMINUTES ] [-- errorminutes ERRORMINUTES ] [-- minutes ] [-- diff ] [-- noyearnotz ] [-- verbose ] date1 date2 positional arguments : date1 date1 ex : \"Mar 18 11:30:38 2017 GMT\" date2 date2 ex : \"Mar 18 19:30:38 2017 GMT\" optional arguments : - h , -- help show this help message and exit -- warnminutes WARNMINUTES set custom level for warning in minutes -- errorminutes ERRORMINUTES set custom level for error in minutes -- minutes just return minutes to warn -- diff just return minutes between the dates -- noyearnotz datetime without year and tz ( aka syslog format ) ex : Jul 27 11 : 36 : 54 -- verbose","title":"Intro"},{"location":"config-management/","text":"Syscheck config management \u00b6 Changes \u00b6 Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates Configuration Management \u00b6 ansible \u00b6 syscheck is configurable with ansible. for more info see the misc/ansible directory. manually \u00b6 Each script has a config under config/ syscheck-scripts \u00b6 Enable scripts by making a soft link (ln -s) in \u201cscripts-enabled\u201d to \u201cscripts-available\u201d where all scripts reside. enable one script: # cd scripts-enabled # ln -s ../scripts-available/sc_01_disk_usage.sh . enable all script: # cd scripts-enabled # ln -s ../scripts-available/* . make a test-run by doing: ./syscheck.sh -s if it works out good (All is OK), then go ahead and try ./sysheck.sh then check your syslog-logs Related scripts \u00b6 Related scripts are other scripts not intended to be run every x min like the core syscheck script but maybe by cron every now and then, maybe by a admin manually to perform a maintenance task. To list the available scripts look in related-available ls related-available To find out more about a certain script run with \u201c-h\u201d as argument: related - available / 900 _export_cert . sh - h To enable a script: cd related - enabled ln - s ../ related - available / 900 _export_cert . sh . Why should you only use related scripts from \u201crelated-enabled\u201d? - Those are configured and tested on this particular installation, so do make it a habit to run stuff only from \u201crelated-enabled\u201d","title":"Config"},{"location":"config-management/#syscheck-config-management","text":"","title":"Syscheck config management"},{"location":"config-management/#changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates","title":"Changes"},{"location":"config-management/#configuration-management","text":"","title":"Configuration Management"},{"location":"config-management/#ansible","text":"syscheck is configurable with ansible. for more info see the misc/ansible directory.","title":"ansible"},{"location":"config-management/#manually","text":"Each script has a config under config/","title":"manually"},{"location":"config-management/#syscheck-scripts","text":"Enable scripts by making a soft link (ln -s) in \u201cscripts-enabled\u201d to \u201cscripts-available\u201d where all scripts reside. enable one script: # cd scripts-enabled # ln -s ../scripts-available/sc_01_disk_usage.sh . enable all script: # cd scripts-enabled # ln -s ../scripts-available/* . make a test-run by doing: ./syscheck.sh -s if it works out good (All is OK), then go ahead and try ./sysheck.sh then check your syslog-logs","title":"syscheck-scripts"},{"location":"config-management/#related-scripts","text":"Related scripts are other scripts not intended to be run every x min like the core syscheck script but maybe by cron every now and then, maybe by a admin manually to perform a maintenance task. To list the available scripts look in related-available ls related-available To find out more about a certain script run with \u201c-h\u201d as argument: related - available / 900 _export_cert . sh - h To enable a script: cd related - enabled ln - s ../ related - available / 900 _export_cert . sh . Why should you only use related scripts from \u201crelated-enabled\u201d? - Those are configured and tested on this particular installation, so do make it a habit to run stuff only from \u201crelated-enabled\u201d","title":"Related scripts"},{"location":"getroot/","text":"Syscheck - GetRoot Tool \u00b6 Changes \u00b6 Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates Intro \u00b6 Small tool to log why you need root before getting access. This is of course in no way enforceable but still easy to follow up if operators do not log their reason. As an incentive getroot manages putting syscheck on hold for the operator. Becoming root \u00b6 $ . / getroot . sh . / getroot . sh : Tool to log changes and to pause syscheck Please state a short but clear reason why you need root > Change CHG123456 - update the version of syscheck stop any new syscheck scripts Y / n ? y [ sudo ] password for han : # #do upgrade # # now all syscheck batch jobs will not run # # exit when ready # exit logout Syscheck is on hold , are you done Y / n ? y Becoming root, keeping syscheck on-hold. \u00b6 $ ./getroot.sh ./getroot.sh: Tool to log changes and to pause syscheck Please state a short but clear reason why you need root > Change CHG123456 - update the version of syscheck stop any new syscheck scripts Y/n?y root@vroom:~# exit logout Syscheck is on hold, are you done Y/n?n Next time getroot is started, is asks if your done \u00b6 $ ./getroot.sh Syscheck is on hold, are you done Y/n?y 700 00 I 7004 han ( 1000 ) User: is done with root reason: Sun Nov 19 12 :32:52 CET 2017 :upgrade syscheck:han","title":"getroot"},{"location":"getroot/#syscheck-getroot-tool","text":"","title":"Syscheck - GetRoot Tool"},{"location":"getroot/#changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates","title":"Changes"},{"location":"getroot/#intro","text":"Small tool to log why you need root before getting access. This is of course in no way enforceable but still easy to follow up if operators do not log their reason. As an incentive getroot manages putting syscheck on hold for the operator.","title":"Intro"},{"location":"getroot/#becoming-root","text":"$ . / getroot . sh . / getroot . sh : Tool to log changes and to pause syscheck Please state a short but clear reason why you need root > Change CHG123456 - update the version of syscheck stop any new syscheck scripts Y / n ? y [ sudo ] password for han : # #do upgrade # # now all syscheck batch jobs will not run # # exit when ready # exit logout Syscheck is on hold , are you done Y / n ? y","title":"Becoming root"},{"location":"getroot/#becoming-root-keeping-syscheck-on-hold","text":"$ ./getroot.sh ./getroot.sh: Tool to log changes and to pause syscheck Please state a short but clear reason why you need root > Change CHG123456 - update the version of syscheck stop any new syscheck scripts Y/n?y root@vroom:~# exit logout Syscheck is on hold, are you done Y/n?n","title":"Becoming root, keeping syscheck on-hold."},{"location":"getroot/#next-time-getroot-is-started-is-asks-if-your-done","text":"$ ./getroot.sh Syscheck is on hold, are you done Y/n?y 700 00 I 7004 han ( 1000 ) User: is done with root reason: Sun Nov 19 12 :32:52 CET 2017 :upgrade syscheck:han","title":"Next time getroot is started, is asks if your done"},{"location":"getting-started/","text":"Syscheck getting started \u00b6 Changes \u00b6 Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates Activate selected related scripts \u00b6 Make the soft links in the related-enabled directory. han@ca-nod1:/opt/syscheck/related-enabled> ln -s ../related-available/904_make_mysql_db_backup.sh . Verify there is soft links and no copied files in enabled! username@smartcard20-node1:/opt/syscheck/syscheck/related-enabled> ls -al lrwxrwxrwx 1 root root 48 2010-06-04 14:25 904_make_mysql_db_backup.sh -> ../related-available/904_make_mysql_db_backup.sh Also check the config for each script you activate, there may or may not be anything to config, but let\u2019s check. username@smartcard20-node1:/opt/syscheck/> sudo vi config/900.conf username@smartcard20-node1:/opt/syscheck/> sudo vi config/904.conf [...] Mysql database configuration \u00b6 Config database parameters Make sure settings are correct in the syscheck config/common.conf DB_NAME=ejbca DB_USER=ejbca DB_PASSWORD=\"sdfiuh3wrnj\" MYSQLROOT_PASSWORD=\"UiywfeW23\"","title":"Getting started"},{"location":"getting-started/#syscheck-getting-started","text":"","title":"Syscheck getting started"},{"location":"getting-started/#changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates","title":"Changes"},{"location":"getting-started/#activate-selected-related-scripts","text":"Make the soft links in the related-enabled directory. han@ca-nod1:/opt/syscheck/related-enabled> ln -s ../related-available/904_make_mysql_db_backup.sh . Verify there is soft links and no copied files in enabled! username@smartcard20-node1:/opt/syscheck/syscheck/related-enabled> ls -al lrwxrwxrwx 1 root root 48 2010-06-04 14:25 904_make_mysql_db_backup.sh -> ../related-available/904_make_mysql_db_backup.sh Also check the config for each script you activate, there may or may not be anything to config, but let\u2019s check. username@smartcard20-node1:/opt/syscheck/> sudo vi config/900.conf username@smartcard20-node1:/opt/syscheck/> sudo vi config/904.conf [...]","title":"Activate selected related scripts"},{"location":"getting-started/#mysql-database-configuration","text":"Config database parameters Make sure settings are correct in the syscheck config/common.conf DB_NAME=ejbca DB_USER=ejbca DB_PASSWORD=\"sdfiuh3wrnj\" MYSQLROOT_PASSWORD=\"UiywfeW23\"","title":"Mysql database configuration"},{"location":"help-getroot/","text":"./getroot.sh: Tool become root and to log changes and to pause syscheck Please state a short but clear reason why you need root Scriptid: 700 - get root This is syscheck, getroot.sh it ask for a reason to get root, logs it then asks if syscheck scripts should be put on hold. Syntax: ./getroot.sh (run interactive) -p|\u2013pause to automatically set/unset syscheck on/off pause -r|\u2013reason set reason from arg Error code / description - What to do 7001 / User: %s is getting root reason: %s - 7002 / User: %s is getting root reason: %s - 7003 / User: %s is getting root, with syscheck on hold reason: %s - 7004 / User: %s is done with root reason: %s - to run with output directed to screen: add a \u2018-s\u2019 or \u2018\u2013screen\u2019","title":"getroot help"},{"location":"help-logbook/","text":"./logbook.sh: Scriptid: 701 - Log book This is syscheck, loogbook.sh it ask for a entry then logs it. -p|\u2013post - to post a new message -r|\u2013read - to read already posted Error code / description - What to do 7011 / User: %s ; Logentry: %s - Logmessage to run with output directed to screen: add a \u2018-s\u2019 or \u2018\u2013screen\u2019","title":"Logbook Help"},{"location":"install/","text":"Syscheck - Install \u00b6 Changes \u00b6 Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates manually \u00b6 untar the distribution in a suitable directory (default /usr/local/syscheck). Then edit config/common.conf config/xxx.conf (where xxx is ther scriptid) to fit your needs. packaged (rpm and deb) \u00b6 Download the rpm/deb from github rpm -Uvh syscheck- .rpm dpkg -i syscheck- .deb","title":"Install"},{"location":"install/#syscheck-install","text":"","title":"Syscheck - Install"},{"location":"install/#changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates","title":"Changes"},{"location":"install/#manually","text":"untar the distribution in a suitable directory (default /usr/local/syscheck). Then edit config/common.conf config/xxx.conf (where xxx is ther scriptid) to fit your needs.","title":"manually"},{"location":"install/#packaged-rpm-and-deb","text":"Download the rpm/deb from github rpm -Uvh syscheck- .rpm dpkg -i syscheck- .deb","title":"packaged (rpm and deb)"},{"location":"integration-with-op5/","text":"Syscheck integration with op5 and icinga \u00b6 Changes \u00b6 Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates Introduction \u00b6 OP5 is an enterprise monitoring solution initally based on nagios. Icinga is a comunity driven fork of nagios. Purpose of the integration is to send infomration from servers that is out of reach for the regular agent. config \u00b6 OP5 and Icinga is turned on/off in config/common.conf # send log messages to icinga http api # values : 0 - disabled or 1 - enabled SENDTO_ICINGA = 0 # send log messages to OP5 http api # values : 0 - disabled or 1 - enabled SENDTO_OP5 = 1 Then API username and password is set in config/monitoring.conf # monitoring ICINGA_USER = \"root\" ICINGA_PASS = \"foo123\" ICINGA_API_URL = \"https://icingaservername:5665/v1/actions/\" OP5_USER = \"root\" OP5_PASS = \"foo123x\" OP5_API_URL = \"https://op5servername/api/command/PROCESS_SERVICE_CHECK_RESULT\" Example Work flow \u00b6 Syscheck run every 10 min As a part of the run syscheck sends information to OP5 sample request: curl -u 'status_update:mysecret' -H 'content-type: application/json' -d '{\"host_name\":\"example_host_1\",\"service_description\":\"Example service\", \"status_code\":\"2\",\"plugin_output\":\"Example issue has occurred\"}' 'https://monitorserver/api/command/PROCESS_SERVICE_CHECK_RESULT' References \u00b6 OP5 API Icinga API","title":"OP5"},{"location":"integration-with-op5/#syscheck-integration-with-op5-and-icinga","text":"","title":"Syscheck integration with op5 and icinga"},{"location":"integration-with-op5/#changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates","title":"Changes"},{"location":"integration-with-op5/#introduction","text":"OP5 is an enterprise monitoring solution initally based on nagios. Icinga is a comunity driven fork of nagios. Purpose of the integration is to send infomration from servers that is out of reach for the regular agent.","title":"Introduction"},{"location":"integration-with-op5/#config","text":"OP5 and Icinga is turned on/off in config/common.conf # send log messages to icinga http api # values : 0 - disabled or 1 - enabled SENDTO_ICINGA = 0 # send log messages to OP5 http api # values : 0 - disabled or 1 - enabled SENDTO_OP5 = 1 Then API username and password is set in config/monitoring.conf # monitoring ICINGA_USER = \"root\" ICINGA_PASS = \"foo123\" ICINGA_API_URL = \"https://icingaservername:5665/v1/actions/\" OP5_USER = \"root\" OP5_PASS = \"foo123x\" OP5_API_URL = \"https://op5servername/api/command/PROCESS_SERVICE_CHECK_RESULT\"","title":"config"},{"location":"integration-with-op5/#example-work-flow","text":"Syscheck run every 10 min As a part of the run syscheck sends information to OP5 sample request: curl -u 'status_update:mysecret' -H 'content-type: application/json' -d '{\"host_name\":\"example_host_1\",\"service_description\":\"Example service\", \"status_code\":\"2\",\"plugin_output\":\"Example issue has occurred\"}' 'https://monitorserver/api/command/PROCESS_SERVICE_CHECK_RESULT'","title":"Example Work flow"},{"location":"integration-with-op5/#references","text":"OP5 API Icinga API","title":"References"},{"location":"logbook/","text":"Syscheck - LOGBOOK Tool \u00b6 Changes \u00b6 Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates Log book is a tool to log activities by the operators, it may be trouble shooting, handover of problems/incidents to next operator or any important info. to enable sudo run: \u00b6 usermod -D wheel -a username logbook samples \u00b6 Help: $ ./logbook.sh -h ./logbook.sh: Tool to log messages to syscheck This is syscheck, loogbook.sh it ask for a entry then logs it. ./logbook.sh [ -r <days> | -p ] ( read is default ) to post an entry, it is a single line, need more lines, just run again. $ ./logbook.sh -p ./logbook.sh: Tool to log messages to syscheck Enter any type of info that needs to be logged into the logbook ( max 160 chars ) > Fault tracing the server is slow read the log, press enter to see next day, ctrl-c to exit $ ./logbook.sh -r ./logbook.sh: Tool to log messages to syscheck Logentries for : 20171119 701 -00-I-7011-PKI 20171119 11 :54:28 vroom: INFO - User: han ; Logentry: Fault tracing the server is slow end-of-entries, press enter to see next day Logentries for : 20171118 end-of-entries, press enter to see next day Logentries for : 20171117 end-of-entries, press enter to see next day Logentries for : 20171116 700 -00-I-7003-PKI 20171116 15 :48:23 vroom: INFO - User: han is getting root, with syscheck on hold reason: Change #363636 - update keystore 47 700 -00-I-7004-PKI 20171116 15 :48:31 vroom: INFO - User: han is done with root reason: Change #363636 - update keystore 47 end-of-entries, press enter to see next day Logentries for : 20171115 end-of-entries, press enter to see next day^C read the log x days and exit (put it in your .bashrc maybe) $ ./logbook.sh -r 7 ./logbook.sh: Tool to log messages to syscheck Logentries for : 20171119 701 -00-I-7011-PKI 20171119 11 :54:28 vroom: INFO - User: han ; Logentry: Fault tracing the server is slow Logentries for : 20171118 Logentries for : 20171117 Logentries for : 20171116 700 -00-I-7003-PKI 20171116 15 :48:23 vroom: INFO - User: han is getting root, with syscheck on hold reason: Change #363636 - update keystore 47 700 -00-I-7004-PKI 20171116 15 :48:31 vroom: INFO - User: han is done with root reason: Change #363636 - update keystore 47 701 -00-I-7011-PKI 20171116 15 :49:21 vroom: INFO - User: han ; Logentry: ny var det konstigt Logentries for : 20171115 Logentries for : 20171114 Logentries for : 20171113","title":"Logbook"},{"location":"logbook/#syscheck-logbook-tool","text":"","title":"Syscheck - LOGBOOK Tool"},{"location":"logbook/#changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates Log book is a tool to log activities by the operators, it may be trouble shooting, handover of problems/incidents to next operator or any important info.","title":"Changes"},{"location":"logbook/#to-enable-sudo-run","text":"usermod -D wheel -a username","title":"to enable sudo run:"},{"location":"logbook/#logbook-samples","text":"Help: $ ./logbook.sh -h ./logbook.sh: Tool to log messages to syscheck This is syscheck, loogbook.sh it ask for a entry then logs it. ./logbook.sh [ -r <days> | -p ] ( read is default ) to post an entry, it is a single line, need more lines, just run again. $ ./logbook.sh -p ./logbook.sh: Tool to log messages to syscheck Enter any type of info that needs to be logged into the logbook ( max 160 chars ) > Fault tracing the server is slow read the log, press enter to see next day, ctrl-c to exit $ ./logbook.sh -r ./logbook.sh: Tool to log messages to syscheck Logentries for : 20171119 701 -00-I-7011-PKI 20171119 11 :54:28 vroom: INFO - User: han ; Logentry: Fault tracing the server is slow end-of-entries, press enter to see next day Logentries for : 20171118 end-of-entries, press enter to see next day Logentries for : 20171117 end-of-entries, press enter to see next day Logentries for : 20171116 700 -00-I-7003-PKI 20171116 15 :48:23 vroom: INFO - User: han is getting root, with syscheck on hold reason: Change #363636 - update keystore 47 700 -00-I-7004-PKI 20171116 15 :48:31 vroom: INFO - User: han is done with root reason: Change #363636 - update keystore 47 end-of-entries, press enter to see next day Logentries for : 20171115 end-of-entries, press enter to see next day^C read the log x days and exit (put it in your .bashrc maybe) $ ./logbook.sh -r 7 ./logbook.sh: Tool to log messages to syscheck Logentries for : 20171119 701 -00-I-7011-PKI 20171119 11 :54:28 vroom: INFO - User: han ; Logentry: Fault tracing the server is slow Logentries for : 20171118 Logentries for : 20171117 Logentries for : 20171116 700 -00-I-7003-PKI 20171116 15 :48:23 vroom: INFO - User: han is getting root, with syscheck on hold reason: Change #363636 - update keystore 47 700 -00-I-7004-PKI 20171116 15 :48:31 vroom: INFO - User: han is done with root reason: Change #363636 - update keystore 47 701 -00-I-7011-PKI 20171116 15 :49:21 vroom: INFO - User: han ; Logentry: ny var det konstigt Logentries for : 20171115 Logentries for : 20171114 Logentries for : 20171113","title":"logbook samples"},{"location":"output-destinations/","text":"Syscheck - LOGBOOK Tool \u00b6 Changes \u00b6 Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates Output to File \u00b6 syscheck can write to a local file, this can be collected by filebeat to be managed in ELK. Output to Syslog \u00b6 Sycheck will send messages to a local syslog server, that server can of course route the messages to a central syslog. Rsyslog has native support for SSL, use this to make sure the messages are kept confidential during transport. You still can use any syslog implementation. Output to Icinga \u00b6 syscheck can send check result directly to icinga http api Icinga API https://icinga.com/docs/icinga2/latest/doc/12-icinga2-api/ Output to OP5 \u00b6 OP5 is an enterprise monitoring solution initally based on nagios. Purpose of the integration is to send infomration from servers that is out of reach for the regular agent. Example Work flow Syscheck run every 10 min As a part of the run syscheck sends information to OP5 sample request: curl -u 'status_update:mysecret' -H 'content-type: application/json' -d '{\"host_name\":\"example_host_1\",\"service_description\":\"Example service\", \"status_code\":\"2\",\"plugin_output\":\"Example issue has occurred\"}' 'https://monitorserver/api/command/PROCESS_SERVICE_CHECK_RESULT' References Nagios API https://kb.op5.com/display/HOWTOs/Submitting+status+updates+through+the+HTTP+API Output to Elastic Stack \u00b6 The JSON output was added for easy integration with elastic. Sample setup: [syscheck installed ] -> [ file output ] -> [ filebeat reads ] -> [ logstash ] -> [ icinga ] [on a server] [ \"/var/log/syscheck.log\"] [ sends logrows ] [ icinga ouput ] [ alerting ] Read more: * https://www.elastic.co/beats/filebeat * https://www.elastic.co","title":"Output destinations"},{"location":"output-destinations/#syscheck-logbook-tool","text":"","title":"Syscheck - LOGBOOK Tool"},{"location":"output-destinations/#changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates","title":"Changes"},{"location":"output-destinations/#output-to-file","text":"syscheck can write to a local file, this can be collected by filebeat to be managed in ELK.","title":"Output to File"},{"location":"output-destinations/#output-to-syslog","text":"Sycheck will send messages to a local syslog server, that server can of course route the messages to a central syslog. Rsyslog has native support for SSL, use this to make sure the messages are kept confidential during transport. You still can use any syslog implementation.","title":"Output to  Syslog"},{"location":"output-destinations/#output-to-icinga","text":"syscheck can send check result directly to icinga http api Icinga API https://icinga.com/docs/icinga2/latest/doc/12-icinga2-api/","title":"Output to  Icinga"},{"location":"output-destinations/#output-to-op5","text":"OP5 is an enterprise monitoring solution initally based on nagios. Purpose of the integration is to send infomration from servers that is out of reach for the regular agent. Example Work flow Syscheck run every 10 min As a part of the run syscheck sends information to OP5 sample request: curl -u 'status_update:mysecret' -H 'content-type: application/json' -d '{\"host_name\":\"example_host_1\",\"service_description\":\"Example service\", \"status_code\":\"2\",\"plugin_output\":\"Example issue has occurred\"}' 'https://monitorserver/api/command/PROCESS_SERVICE_CHECK_RESULT' References Nagios API https://kb.op5.com/display/HOWTOs/Submitting+status+updates+through+the+HTTP+API","title":"Output to  OP5"},{"location":"output-destinations/#output-to-elastic-stack","text":"The JSON output was added for easy integration with elastic. Sample setup: [syscheck installed ] -> [ file output ] -> [ filebeat reads ] -> [ logstash ] -> [ icinga ] [on a server] [ \"/var/log/syscheck.log\"] [ sends logrows ] [ icinga ouput ] [ alerting ] Read more: * https://www.elastic.co/beats/filebeat * https://www.elastic.co","title":"Output to  Elastic Stack"},{"location":"output-format/","text":"Syscheck output formats \u00b6 Changes \u00b6 Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates Introduction \u00b6 in version 1.7 JSON output format was added. in version 1.6 the output format has changes to support pushing messages to icinga/nagios (and mayby other monitoring solutions also). Info - JSON Syscheck Sample output \u00b6 { \"FROM\": \"SYSCHECK\", \"SYSCHECK_VERSION\": \"trunk\", \"LOGFMT\": \"JSON-1.0\", \"SCRIPTID\": \"01\", \"SCRIPTINDEX\": \"01\", \"LEVEL\": \"E\", \"ERRNO\": \"02\", \"SYSTEMNAME\": \"PKI\", \"DATE\": \"20150426 20:59:32\", \"HOSTNAME\": \"bang\", \"SEC1970NANO\": \"1430074772.388541169\", \"LONGLEVEL\": \"ERROR\", \"DESCRIPTION\": \"Diskusage exceeded ( is percent used: Limit is percent)\", \"EXTRAARG1\": \"/\", \"EXTRAARG2\": \"99\", \"EXTRAARG3\": \"75\", \"EXTRAARG4\": \"\", \"EXTRAARG5\": \"\", \"EXTRAARG6\": \"\", \"EXTRAARG7\": \"\", \"EXTRAARG8\": \"\", \"EXTRAARG9\": \"\", \"LEGACYFMT\": \"01-01-E-02-PKI 20150426 20:59:32 bang: ERROR - Diskusage exceeded (/ is 99 percent used: Limit is 75 percent)\" } { \"FROM\": \"SYSCHECK\", \"SYSCHECK_VERSION\": \"trunk\", \"LOGFMT\": \"JSON-1.0\", \"SCRIPTID\": \"01\", \"SCRIPTINDEX\": \"02\", \"LEVEL\": \"E\", \"ERRNO\": \"02\", \"SYSTEMNAME\": \"PKI\", \"DATE\": \"20150426 20:59:32\", \"HOSTNAME\": \"bang\", \"SEC1970NANO\": \"1430074772.416035932\", \"LONGLEVEL\": \"ERROR\", \"DESCRIPTION\": \"Diskusage exceeded ( is percent used: Limit is percent)\", \"EXTRAARG1\": \"/backup\", \"EXTRAARG2\": \"99\", \"EXTRAARG3\": \"75\", \"EXTRAARG4\": \"\", \"EXTRAARG5\": \"\", \"EXTRAARG6\": \"\", \"EXTRAARG7\": \"\", \"EXTRAARG8\": \"\", \"EXTRAARG9\": \"\", \"LEGACYFMT\": \"01-02-E-02-PKI 20150426 20:59:32 bang: ERROR - Diskusage exceeded (/backup is 99 percent used: Limit is 75 percent)\" } { \"FROM\": \"SYSCHECK\", \"SYSCHECK_VERSION\": \"trunk\", \"LOGFMT\": \"JSON-1.0\", \"SCRIPTID\": \"02\", \"SCRIPTINDEX\": \"01\", \"LEVEL\": \"E\", \"ERRNO\": \"04\", \"SYSTEMNAME\": \"PKI\", \"DATE\": \"20150426 20:59:32\", \"HOSTNAME\": \"bang\", \"SEC1970NANO\": \"1430074772.483664082\", \"LONGLEVEL\": \"ERROR\", \"DESCRIPTION\": \"EJBCA : application server unavailable\", \"EXTRAARG1\": \"\", \"EXTRAARG2\": \"\", \"EXTRAARG3\": \"\", \"EXTRAARG4\": \"\", \"EXTRAARG5\": \"\", \"EXTRAARG6\": \"\", \"EXTRAARG7\": \"\", \"EXTRAARG8\": \"\", \"EXTRAARG9\": \"\", \"LEGACYFMT\": \"02-01-E-04-PKI 20150426 20:59:32 bang: ERROR - EJBCA : application server unavailable\" } { \"FROM\": \"SYSCHECK\", \"SYSCHECK_VERSION\": \"trunk\", \"LOGFMT\": \"JSON-1.0\", \"SCRIPTID\": \"03\", \"SCRIPTINDEX\": \"01\", \"LEVEL\": \"I\", \"ERRNO\": \"02\", \"SYSTEMNAME\": \"PKI\", \"DATE\": \"20150426 20:59:32\", \"HOSTNAME\": \"bang\", \"SEC1970NANO\": \"1430074772.521154236\", \"LONGLEVEL\": \"INFO\", \"DESCRIPTION\": \"Memory limit ok (Memory is KB used: Limit is KB)\", \"EXTRAARG1\": \"3825580\", \"EXTRAARG2\": \"13079398\", \"EXTRAARG3\": \"\", \"EXTRAARG4\": \"\", \"EXTRAARG5\": \"\", \"EXTRAARG6\": \"\", \"EXTRAARG7\": \"\", \"EXTRAARG8\": \"\", \"EXTRAARG9\": \"\", \"LEGACYFMT\": \"03-01-I-02-PKI 20150426 20:59:32 bang: INFO - Memory limit ok (Memory is 3825580 KB used: Limit is 13079398 KB)\" } Info - JSON Format description: \u00b6 { \"FROM\":\"SYSCHECK\", \"SYSCHECK_VERSION\":\"trunk\", \"LOGFMT\":\"JSON-1.0\", \"SCRIPTID\":\"30\", \"SCRIPTINDEX\":\"01\", \"LEVEL\":\"I\", \"ERRNO\":\"01\", \"SYSTEMNAME\":\"PKI\", \"DATE\":\"20150426 20:59:34\", \"HOSTNAME\":\"bang\", \"SEC1970NANO\":\"1430074774.745658970\", \"LONGLEVEL\":\"INFO\", \"DESCRIPTION\":\"Process is running\", \"EXTRAARG1\":\"apache2\", \"EXTRAARG2\":\"\", \"EXTRAARG3\":\"\", \"EXTRAARG4\":\"\", \"EXTRAARG5\":\"\", \"EXTRAARG6\":\"\", \"EXTRAARG7\":\"\", \"EXTRAARG8\":\"\", \"EXTRAARG9\":\"\", \"LEGACYFMT\":\"30-01-I-01-PKI 20150426 20:59:34 bang: INFO - Process apache2 is running\" } Info - NEWFMT Syscheck Sample output \u00b6 / opt / syscheck ] $ ./ console_syscheck . sh 01 - 01 - I - 01 - PKI 20140904 09 : 27 : 19 hostname : INFO - Diskusage ok ( / is 3 percent used : Limit is 75 percent ) 01 - 02 - I - 01 - PKI 20140904 09 : 27 : 19 hostname : INFO - Diskusage ok ( / backup is 43 percent used : Limit is 75 percent ) 01 - 03 - I - 01 - PKI 20140904 09 : 27 : 19 hostname : INFO - Diskusage ok ( / var / lib is 4 percent used : Limit is 75 percent ) 01 - 04 - I - 01 - PKI 20140904 09 : 27 : 19 hostname : INFO - Diskusage ok ( / var / log is 1 percent used : Limit is 75 percent ) 02 - 01 - I - 01 - PKI 20140904 09 : 27 : 19 hostname : INFO - EJBCA : ALLOK 03 - 01 - I - 02 - PKI 20140904 09 : 27 : 19 hostname : INFO - Memory limit ok ( Memory is 7734720 KB used : Limit is 13054803 KB ) 03 - 02 - I - 03 - PKI 20140904 09 : 27 : 19 hostname : INFO - Swap limit ok ( Swap is 279412 KB used : Limit is 21921788 KB ) 06 - 01 - I - 01 - PKI 20140904 09 : 27 : 20 hostname : INFO - PhysicalDiscs is OK physicaldrive 1 I : 1 : 1 ( port 1 I : box 1 : bay 1 , SAS , 300 GB , OK ) 06 - 02 - I - 01 - PKI 20140904 09 : 27 : 21 hostname : INFO - PhysicalDiscs is OK physicaldrive 1 I : 1 : 2 ( port 1 I : box 1 : bay 2 , SAS , 300 GB , OK ) 06 - 03 - I - 01 - PKI 20140904 09 : 27 : 22 hostname : INFO - PhysicalDiscs is OK physicaldrive 1 I : 1 : 3 ( port 1 I : box 1 : bay 3 , SAS , 300 GB , OK ) 06 - 04 - I - 01 - PKI 20140904 09 : 27 : 22 hostname : INFO - PhysicalDiscs is OK physicaldrive 1 I : 1 : 4 ( port 1 I : box 1 : bay 4 , SAS , 300 GB , OK ) 06 - 05 - I - 03 - PKI 20140904 09 : 27 : 23 hostname : INFO - LogicalDiscs is OK logicaldrive 1 ( 838.1 GB , RAID 5 , OK ) 07 - 01 - I - 04 - PKI 20140904 09 : 27 : 24 hostname : INFO - Syslog is running and delivers messages 09 - 02 - I - 03 - PKI 20140904 09 : 27 : 24 hostname : INFO - Firewall is up and configured properly 12 - 01 - I - 01 - PKI 20140904 09 : 27 : 24 hostname : INFO - mysql is running 17 - 02 - I - 01 - PKI 20140904 09 : 27 : 24 hostname : INFO - ntpd is in sync with server : 10.1 . 1.1 19 - 01 - I - 03 - PKI 20140904 09 : 27 : 24 hostname : INFO - I 'm alive 20 - 01 - I - 01 - PKI 20140904 09 : 27 : 24 hostname : INFO - No new errors in ejbca server log 31 - 01 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of PSU1 is OK 31 - 02 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of PSU2 is OK 31 - 06 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #1 AMBIENT Current: 25 Limit: 41 (celsius) is OK 31 - 10 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #2 CPU#1 Current: 40 Limit: 82 (celsius) is OK 31 - 14 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #3 CPU#2 Current: 40 Limit: 82 (celsius) is OK 31 - 18 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #4 MEMORY_BD Current: 32 Limit: 87 (celsius) is OK 31 - 22 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #5 MEMORY_BD Current: 32 Limit: 87 (celsius) is OK 31 - 26 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #6 MEMORY_BD Current: 34 Limit: 87 (celsius) is OK 31 - 30 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #7 MEMORY_BD Current: 35 Limit: 87 (celsius) is OK 31 - 34 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #8 SYSTEM_BD Current: 41 Limit: 90 (celsius) is OK 31 - 38 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #9 SYSTEM_BD Current: 36 Limit: 65 (celsius) is OK 31 - 42 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #10 SYSTEM_BD Current: 44 Limit: 90 (celsius) is OK 31 - 46 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #11 SYSTEM_BD Current: 33 Limit: 70 (celsius) is OK 31 - 50 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #12 SYSTEM_BD Current: 42 Limit: 90 (celsius) is OK 31 - 54 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #13 I/O_ZONE Current: 32 Limit: 70 (celsius) is OK 31 - 58 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #14 I/O_ZONE Current: 35 Limit: 70 (celsius) is OK 31 - 62 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #15 I/O_ZONE Current: 34 Limit: 70 (celsius) is OK 31 - 63 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #16 I/O_ZONE is known not to give any reading (#16;I/O_ZONE;-;70C/158F;) is OK 31 - 64 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #17 I/O_ZONE is known not to give any reading (#17;I/O_ZONE;-;70C/158F;) is OK 31 - 65 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #18 I/O_ZONE is known not to give any reading (#18;I/O_ZONE;-;70C/158F;) is OK 31 - 69 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #19 SYSTEM_BD Current: 27 Limit: 70 (celsius) is OK 31 - 73 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #20 SYSTEM_BD Current: 30 Limit: 70 (celsius) is OK 31 - 77 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #21 SYSTEM_BD Current: 32 Limit: 80 (celsius) is OK 31 - 81 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #22 SYSTEM_BD Current: 32 Limit: 80 (celsius) is OK 31 - 85 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #23 SYSTEM_BD Current: 39 Limit: 77 (celsius) is OK 31 - 89 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of TEMP #24 SYSTEM_BD Current: 34 Limit: 70 (celsius) is OK 31 - 93 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of TEMP #25 SYSTEM_BD Current: 33 Limit: 70 (celsius) is OK 31 - 97 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of TEMP #26 SYSTEM_BD Current: 34 Limit: 70 (celsius) is OK 31 - 98 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of TEMP #27 I/O_ZONE is known not to give any reading (#27;I/O_ZONE;-;70C/158F;) is OK 31 - 99 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of TEMP #28 I/O_ZONE is known not to give any reading (#28;I/O_ZONE;-;70C/158F;) is OK 31 - 103 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of TEMP #29 SCSI_BACKPLANE_ZONE Current: 35 Limit: 60 (celsius) is OK 31 - 107 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of TEMP #30 SYSTEM_BD Current: 64 Limit: 110 (celsius) is OK 31 - 108 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of FAN ( #1) IS in normal operation (NORMAL/29%) is OK 31 - 109 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of FAN ( #2) IS in normal operation (NORMAL/30%) is OK 31 - 110 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of FAN ( #3) IS in normal operation (NORMAL/35%) is OK 31 - 111 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of FAN ( #4) IS in normal operation (NORMAL/35%) is OK 31 - 112 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of FAN ( #5) IS in normal operation (NORMAL/30%) is OK 31 - 113 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of FAN ( #6) IS in normal operation (NORMAL/13%) is OK Info - NEWFMT Format description: \u00b6 01-01-I-01-PKI 20140904 09:27:19 hostname: INFO - Diskusage ok (/ is 3 percent used: Limit is 75 percent) I-0101-PKI 20090328 22:54:23 plup: INFO - Diskusage ok (/ is 51 percent used: Limit is 95 percent) ``` ScriptID, unique id for the script, usally 2 numbers byt may be more, use the - as separator \u201d-\u201d Separator ScriptIndex, unique index for the test (eg. 01 for the first disc tested, 02 for the second and so on..), usally 2 numbers byt may be more, use the - as separator \u201d-\u201d Separator ErrorLevel - Can be I for INFO, W for Warning or E for Error \u201d-\u201d Separator Status code, usally 2 numbers byt may be more, use the - as separator \u201d-\u201d Separator System ID \u201d \u201d Separator 12: date and time YYYYMMDD HH:MM:SS Systemname \u201d:\u201d Separator \u201d \u201d Separator Level spelled out \u201d - \u201d Separator 18 - . Message ### Info - OLDFMT Syscheck Sample output /opt/syscheck$ ./syscheck.sh -s I-0101-PKI 20090328 22:54:23 plup: INFO - Diskusage ok (/ is 51 percent used: Limit is 95 percent) E-0203-PKI 20090328 22:54:23 plup: ERROR - EJBCA : Application Server is unavailable I-0302-PKI 20090328 22:54:23 plup: INFO - Memory limit ok (Memory is 869492 KB used: Limit is 1613286 KB) I-0303-PKI 20090328 22:54:23 plup: INFO - Swap limit ok (Swap is 18672 KB used: Limit is 2963988 KB) E-0402-PKI 20090328 22:54:24 plup: ERROR - Wrong number of attached pcsc-readers () I-0501-PKI 20090328 22:54:24 plup: INFO - pcscd is running E-0606-PKI 20090328 22:54:24 plup: ERROR - HPTOOL not installed at: /usr/sbin/hpacucli E-0703-PKI 20090328 22:54:24 plup: ERROR - syslog is not running E-0803-PKI 20090328 22:54:25 plup: ERROR - Unable to get CRL http://localhost/crl/eIDCA.crl from webserver E-0901-PKI 20090328 22:54:25 plup: ERROR - Firewall seems to be turned off. E-1102-PKI 20090328 22:54:35 plup: ERROR - heartbeat is NOT running I-1201-PKI 20090328 22:54:35 plup: INFO - mysql is running E-1403-PKI 20090328 22:54:35 plup: ERROR - Unpredicted error in SW-raid 8 / 0 () E-1502-PKI 20090328 22:54:35 plup: ERROR - Apache webserver is not running E-1602-PKI 20090328 22:54:36 plup: ERROR - LDAP directory server is not running E-1703-PKI 20090328 22:54:36 plup: ERROR - ntpd can\u2019t synchronize a server I-1801-PKI 20090328 22:54:36 plup: INFO - mysql is running and answering I-1903-PKI 20090328 22:54:36 plup: INFO - I\u2019m alive ### Info - OLDFMT Format description: I-0101-PKI 20090328 22:54:23 plup: INFO - Diskusage ok (/ is 51 percent used: Limit is 95 percent) With fixed width: 1. \u201cI\u201d - Can be I for INFO, W for Warning or E for Error 2. \u201c-\u201d Separator 3-5. Script ID 6. Status code 7. \u201c-\u201d Separator 8-10. System ID 11. \u201d \u201d Separator 12-28: date and time YYYYMMDD HH:MM:SS With Variable width: 29-32. Systemname 33. \u201c:\u201d Separator 34. \u201d \u201d Separator 35-38. Level spelled out 39-41. \u201d - \u201d Separator 42 - . Message ```","title":"Output Formats"},{"location":"output-format/#syscheck-output-formats","text":"","title":"Syscheck output formats"},{"location":"output-format/#changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates","title":"Changes"},{"location":"output-format/#introduction","text":"in version 1.7 JSON output format was added. in version 1.6 the output format has changes to support pushing messages to icinga/nagios (and mayby other monitoring solutions also).","title":"Introduction"},{"location":"output-format/#info-json-syscheck-sample-output","text":"{ \"FROM\": \"SYSCHECK\", \"SYSCHECK_VERSION\": \"trunk\", \"LOGFMT\": \"JSON-1.0\", \"SCRIPTID\": \"01\", \"SCRIPTINDEX\": \"01\", \"LEVEL\": \"E\", \"ERRNO\": \"02\", \"SYSTEMNAME\": \"PKI\", \"DATE\": \"20150426 20:59:32\", \"HOSTNAME\": \"bang\", \"SEC1970NANO\": \"1430074772.388541169\", \"LONGLEVEL\": \"ERROR\", \"DESCRIPTION\": \"Diskusage exceeded ( is percent used: Limit is percent)\", \"EXTRAARG1\": \"/\", \"EXTRAARG2\": \"99\", \"EXTRAARG3\": \"75\", \"EXTRAARG4\": \"\", \"EXTRAARG5\": \"\", \"EXTRAARG6\": \"\", \"EXTRAARG7\": \"\", \"EXTRAARG8\": \"\", \"EXTRAARG9\": \"\", \"LEGACYFMT\": \"01-01-E-02-PKI 20150426 20:59:32 bang: ERROR - Diskusage exceeded (/ is 99 percent used: Limit is 75 percent)\" } { \"FROM\": \"SYSCHECK\", \"SYSCHECK_VERSION\": \"trunk\", \"LOGFMT\": \"JSON-1.0\", \"SCRIPTID\": \"01\", \"SCRIPTINDEX\": \"02\", \"LEVEL\": \"E\", \"ERRNO\": \"02\", \"SYSTEMNAME\": \"PKI\", \"DATE\": \"20150426 20:59:32\", \"HOSTNAME\": \"bang\", \"SEC1970NANO\": \"1430074772.416035932\", \"LONGLEVEL\": \"ERROR\", \"DESCRIPTION\": \"Diskusage exceeded ( is percent used: Limit is percent)\", \"EXTRAARG1\": \"/backup\", \"EXTRAARG2\": \"99\", \"EXTRAARG3\": \"75\", \"EXTRAARG4\": \"\", \"EXTRAARG5\": \"\", \"EXTRAARG6\": \"\", \"EXTRAARG7\": \"\", \"EXTRAARG8\": \"\", \"EXTRAARG9\": \"\", \"LEGACYFMT\": \"01-02-E-02-PKI 20150426 20:59:32 bang: ERROR - Diskusage exceeded (/backup is 99 percent used: Limit is 75 percent)\" } { \"FROM\": \"SYSCHECK\", \"SYSCHECK_VERSION\": \"trunk\", \"LOGFMT\": \"JSON-1.0\", \"SCRIPTID\": \"02\", \"SCRIPTINDEX\": \"01\", \"LEVEL\": \"E\", \"ERRNO\": \"04\", \"SYSTEMNAME\": \"PKI\", \"DATE\": \"20150426 20:59:32\", \"HOSTNAME\": \"bang\", \"SEC1970NANO\": \"1430074772.483664082\", \"LONGLEVEL\": \"ERROR\", \"DESCRIPTION\": \"EJBCA : application server unavailable\", \"EXTRAARG1\": \"\", \"EXTRAARG2\": \"\", \"EXTRAARG3\": \"\", \"EXTRAARG4\": \"\", \"EXTRAARG5\": \"\", \"EXTRAARG6\": \"\", \"EXTRAARG7\": \"\", \"EXTRAARG8\": \"\", \"EXTRAARG9\": \"\", \"LEGACYFMT\": \"02-01-E-04-PKI 20150426 20:59:32 bang: ERROR - EJBCA : application server unavailable\" } { \"FROM\": \"SYSCHECK\", \"SYSCHECK_VERSION\": \"trunk\", \"LOGFMT\": \"JSON-1.0\", \"SCRIPTID\": \"03\", \"SCRIPTINDEX\": \"01\", \"LEVEL\": \"I\", \"ERRNO\": \"02\", \"SYSTEMNAME\": \"PKI\", \"DATE\": \"20150426 20:59:32\", \"HOSTNAME\": \"bang\", \"SEC1970NANO\": \"1430074772.521154236\", \"LONGLEVEL\": \"INFO\", \"DESCRIPTION\": \"Memory limit ok (Memory is KB used: Limit is KB)\", \"EXTRAARG1\": \"3825580\", \"EXTRAARG2\": \"13079398\", \"EXTRAARG3\": \"\", \"EXTRAARG4\": \"\", \"EXTRAARG5\": \"\", \"EXTRAARG6\": \"\", \"EXTRAARG7\": \"\", \"EXTRAARG8\": \"\", \"EXTRAARG9\": \"\", \"LEGACYFMT\": \"03-01-I-02-PKI 20150426 20:59:32 bang: INFO - Memory limit ok (Memory is 3825580 KB used: Limit is 13079398 KB)\" }","title":"Info - JSON Syscheck Sample output"},{"location":"output-format/#info-json-format-description","text":"{ \"FROM\":\"SYSCHECK\", \"SYSCHECK_VERSION\":\"trunk\", \"LOGFMT\":\"JSON-1.0\", \"SCRIPTID\":\"30\", \"SCRIPTINDEX\":\"01\", \"LEVEL\":\"I\", \"ERRNO\":\"01\", \"SYSTEMNAME\":\"PKI\", \"DATE\":\"20150426 20:59:34\", \"HOSTNAME\":\"bang\", \"SEC1970NANO\":\"1430074774.745658970\", \"LONGLEVEL\":\"INFO\", \"DESCRIPTION\":\"Process is running\", \"EXTRAARG1\":\"apache2\", \"EXTRAARG2\":\"\", \"EXTRAARG3\":\"\", \"EXTRAARG4\":\"\", \"EXTRAARG5\":\"\", \"EXTRAARG6\":\"\", \"EXTRAARG7\":\"\", \"EXTRAARG8\":\"\", \"EXTRAARG9\":\"\", \"LEGACYFMT\":\"30-01-I-01-PKI 20150426 20:59:34 bang: INFO - Process apache2 is running\" }","title":"Info - JSON Format description:"},{"location":"output-format/#info-newfmt-syscheck-sample-output","text":"/ opt / syscheck ] $ ./ console_syscheck . sh 01 - 01 - I - 01 - PKI 20140904 09 : 27 : 19 hostname : INFO - Diskusage ok ( / is 3 percent used : Limit is 75 percent ) 01 - 02 - I - 01 - PKI 20140904 09 : 27 : 19 hostname : INFO - Diskusage ok ( / backup is 43 percent used : Limit is 75 percent ) 01 - 03 - I - 01 - PKI 20140904 09 : 27 : 19 hostname : INFO - Diskusage ok ( / var / lib is 4 percent used : Limit is 75 percent ) 01 - 04 - I - 01 - PKI 20140904 09 : 27 : 19 hostname : INFO - Diskusage ok ( / var / log is 1 percent used : Limit is 75 percent ) 02 - 01 - I - 01 - PKI 20140904 09 : 27 : 19 hostname : INFO - EJBCA : ALLOK 03 - 01 - I - 02 - PKI 20140904 09 : 27 : 19 hostname : INFO - Memory limit ok ( Memory is 7734720 KB used : Limit is 13054803 KB ) 03 - 02 - I - 03 - PKI 20140904 09 : 27 : 19 hostname : INFO - Swap limit ok ( Swap is 279412 KB used : Limit is 21921788 KB ) 06 - 01 - I - 01 - PKI 20140904 09 : 27 : 20 hostname : INFO - PhysicalDiscs is OK physicaldrive 1 I : 1 : 1 ( port 1 I : box 1 : bay 1 , SAS , 300 GB , OK ) 06 - 02 - I - 01 - PKI 20140904 09 : 27 : 21 hostname : INFO - PhysicalDiscs is OK physicaldrive 1 I : 1 : 2 ( port 1 I : box 1 : bay 2 , SAS , 300 GB , OK ) 06 - 03 - I - 01 - PKI 20140904 09 : 27 : 22 hostname : INFO - PhysicalDiscs is OK physicaldrive 1 I : 1 : 3 ( port 1 I : box 1 : bay 3 , SAS , 300 GB , OK ) 06 - 04 - I - 01 - PKI 20140904 09 : 27 : 22 hostname : INFO - PhysicalDiscs is OK physicaldrive 1 I : 1 : 4 ( port 1 I : box 1 : bay 4 , SAS , 300 GB , OK ) 06 - 05 - I - 03 - PKI 20140904 09 : 27 : 23 hostname : INFO - LogicalDiscs is OK logicaldrive 1 ( 838.1 GB , RAID 5 , OK ) 07 - 01 - I - 04 - PKI 20140904 09 : 27 : 24 hostname : INFO - Syslog is running and delivers messages 09 - 02 - I - 03 - PKI 20140904 09 : 27 : 24 hostname : INFO - Firewall is up and configured properly 12 - 01 - I - 01 - PKI 20140904 09 : 27 : 24 hostname : INFO - mysql is running 17 - 02 - I - 01 - PKI 20140904 09 : 27 : 24 hostname : INFO - ntpd is in sync with server : 10.1 . 1.1 19 - 01 - I - 03 - PKI 20140904 09 : 27 : 24 hostname : INFO - I 'm alive 20 - 01 - I - 01 - PKI 20140904 09 : 27 : 24 hostname : INFO - No new errors in ejbca server log 31 - 01 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of PSU1 is OK 31 - 02 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of PSU2 is OK 31 - 06 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #1 AMBIENT Current: 25 Limit: 41 (celsius) is OK 31 - 10 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #2 CPU#1 Current: 40 Limit: 82 (celsius) is OK 31 - 14 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #3 CPU#2 Current: 40 Limit: 82 (celsius) is OK 31 - 18 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #4 MEMORY_BD Current: 32 Limit: 87 (celsius) is OK 31 - 22 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #5 MEMORY_BD Current: 32 Limit: 87 (celsius) is OK 31 - 26 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #6 MEMORY_BD Current: 34 Limit: 87 (celsius) is OK 31 - 30 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #7 MEMORY_BD Current: 35 Limit: 87 (celsius) is OK 31 - 34 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #8 SYSTEM_BD Current: 41 Limit: 90 (celsius) is OK 31 - 38 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #9 SYSTEM_BD Current: 36 Limit: 65 (celsius) is OK 31 - 42 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #10 SYSTEM_BD Current: 44 Limit: 90 (celsius) is OK 31 - 46 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #11 SYSTEM_BD Current: 33 Limit: 70 (celsius) is OK 31 - 50 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #12 SYSTEM_BD Current: 42 Limit: 90 (celsius) is OK 31 - 54 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #13 I/O_ZONE Current: 32 Limit: 70 (celsius) is OK 31 - 58 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #14 I/O_ZONE Current: 35 Limit: 70 (celsius) is OK 31 - 62 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #15 I/O_ZONE Current: 34 Limit: 70 (celsius) is OK 31 - 63 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #16 I/O_ZONE is known not to give any reading (#16;I/O_ZONE;-;70C/158F;) is OK 31 - 64 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #17 I/O_ZONE is known not to give any reading (#17;I/O_ZONE;-;70C/158F;) is OK 31 - 65 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #18 I/O_ZONE is known not to give any reading (#18;I/O_ZONE;-;70C/158F;) is OK 31 - 69 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #19 SYSTEM_BD Current: 27 Limit: 70 (celsius) is OK 31 - 73 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #20 SYSTEM_BD Current: 30 Limit: 70 (celsius) is OK 31 - 77 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #21 SYSTEM_BD Current: 32 Limit: 80 (celsius) is OK 31 - 81 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #22 SYSTEM_BD Current: 32 Limit: 80 (celsius) is OK 31 - 85 - I - 01 - PKI 20140904 09 : 27 : 25 hostname : INFO - Sensor of TEMP #23 SYSTEM_BD Current: 39 Limit: 77 (celsius) is OK 31 - 89 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of TEMP #24 SYSTEM_BD Current: 34 Limit: 70 (celsius) is OK 31 - 93 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of TEMP #25 SYSTEM_BD Current: 33 Limit: 70 (celsius) is OK 31 - 97 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of TEMP #26 SYSTEM_BD Current: 34 Limit: 70 (celsius) is OK 31 - 98 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of TEMP #27 I/O_ZONE is known not to give any reading (#27;I/O_ZONE;-;70C/158F;) is OK 31 - 99 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of TEMP #28 I/O_ZONE is known not to give any reading (#28;I/O_ZONE;-;70C/158F;) is OK 31 - 103 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of TEMP #29 SCSI_BACKPLANE_ZONE Current: 35 Limit: 60 (celsius) is OK 31 - 107 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of TEMP #30 SYSTEM_BD Current: 64 Limit: 110 (celsius) is OK 31 - 108 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of FAN ( #1) IS in normal operation (NORMAL/29%) is OK 31 - 109 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of FAN ( #2) IS in normal operation (NORMAL/30%) is OK 31 - 110 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of FAN ( #3) IS in normal operation (NORMAL/35%) is OK 31 - 111 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of FAN ( #4) IS in normal operation (NORMAL/35%) is OK 31 - 112 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of FAN ( #5) IS in normal operation (NORMAL/30%) is OK 31 - 113 - I - 01 - PKI 20140904 09 : 27 : 26 hostname : INFO - Sensor of FAN ( #6) IS in normal operation (NORMAL/13%) is OK","title":"Info - NEWFMT Syscheck Sample output"},{"location":"output-format/#info-newfmt-format-description","text":"01-01-I-01-PKI 20140904 09:27:19 hostname: INFO - Diskusage ok (/ is 3 percent used: Limit is 75 percent) I-0101-PKI 20090328 22:54:23 plup: INFO - Diskusage ok (/ is 51 percent used: Limit is 95 percent) ``` ScriptID, unique id for the script, usally 2 numbers byt may be more, use the - as separator \u201d-\u201d Separator ScriptIndex, unique index for the test (eg. 01 for the first disc tested, 02 for the second and so on..), usally 2 numbers byt may be more, use the - as separator \u201d-\u201d Separator ErrorLevel - Can be I for INFO, W for Warning or E for Error \u201d-\u201d Separator Status code, usally 2 numbers byt may be more, use the - as separator \u201d-\u201d Separator System ID \u201d \u201d Separator 12: date and time YYYYMMDD HH:MM:SS Systemname \u201d:\u201d Separator \u201d \u201d Separator Level spelled out \u201d - \u201d Separator 18 - . Message ### Info - OLDFMT Syscheck Sample output /opt/syscheck$ ./syscheck.sh -s I-0101-PKI 20090328 22:54:23 plup: INFO - Diskusage ok (/ is 51 percent used: Limit is 95 percent) E-0203-PKI 20090328 22:54:23 plup: ERROR - EJBCA : Application Server is unavailable I-0302-PKI 20090328 22:54:23 plup: INFO - Memory limit ok (Memory is 869492 KB used: Limit is 1613286 KB) I-0303-PKI 20090328 22:54:23 plup: INFO - Swap limit ok (Swap is 18672 KB used: Limit is 2963988 KB) E-0402-PKI 20090328 22:54:24 plup: ERROR - Wrong number of attached pcsc-readers () I-0501-PKI 20090328 22:54:24 plup: INFO - pcscd is running E-0606-PKI 20090328 22:54:24 plup: ERROR - HPTOOL not installed at: /usr/sbin/hpacucli E-0703-PKI 20090328 22:54:24 plup: ERROR - syslog is not running E-0803-PKI 20090328 22:54:25 plup: ERROR - Unable to get CRL http://localhost/crl/eIDCA.crl from webserver E-0901-PKI 20090328 22:54:25 plup: ERROR - Firewall seems to be turned off. E-1102-PKI 20090328 22:54:35 plup: ERROR - heartbeat is NOT running I-1201-PKI 20090328 22:54:35 plup: INFO - mysql is running E-1403-PKI 20090328 22:54:35 plup: ERROR - Unpredicted error in SW-raid 8 / 0 () E-1502-PKI 20090328 22:54:35 plup: ERROR - Apache webserver is not running E-1602-PKI 20090328 22:54:36 plup: ERROR - LDAP directory server is not running E-1703-PKI 20090328 22:54:36 plup: ERROR - ntpd can\u2019t synchronize a server I-1801-PKI 20090328 22:54:36 plup: INFO - mysql is running and answering I-1903-PKI 20090328 22:54:36 plup: INFO - I\u2019m alive ### Info - OLDFMT Format description: I-0101-PKI 20090328 22:54:23 plup: INFO - Diskusage ok (/ is 51 percent used: Limit is 95 percent) With fixed width: 1. \u201cI\u201d - Can be I for INFO, W for Warning or E for Error 2. \u201c-\u201d Separator 3-5. Script ID 6. Status code 7. \u201c-\u201d Separator 8-10. System ID 11. \u201d \u201d Separator 12-28: date and time YYYYMMDD HH:MM:SS With Variable width: 29-32. Systemname 33. \u201c:\u201d Separator 34. \u201d \u201d Separator 35-38. Level spelled out 39-41. \u201d - \u201d Separator 42 - . Message ```","title":"Info - NEWFMT Format description:"},{"location":"related-scripts/","text":"Syscheck version 2.0 \u00b6 Documentation generated: Mon 10 Aug 00:13:14 CEST 2020 Syscheck related scripts \u00b6 900_export_cert.sh \u00b6 Scriptid : 900 - Export certificate file Export certificate and archive them , ./ 900 _export_cert . sh < certfile > Error code / description - What to do 9001 / Export certificate run successfully - no actions needed 9002 / Export certificate failed (% s ) - Unexpected , run the script with sh - x to check 9003 / Export certificate failed , script called without file - call this script with a PEM encoded certficate as arg1 to run with output directed to screen : add a '-s' or '--screen' 901_export_revocation.sh \u00b6 Scriptid : 901 - Export CRL file Export CRL : s with a script ./ 901 _export_revocation . sh < DER - encoded CERT > Error code / description - What to do 9011 / Export revocation run successfully - no actions needed 9012 / Export revocation failed (%s) - check manually with sh -x ./ 901 _export_revocation . sh < file > 9013 / Export revocation failed , script called without file - call this script with a DER encoded CERT as arg1 to run with output directed to screen : add a '-s' or '--screen' 902_export_crl.sh \u00b6 Scriptid : 902 - Export revoked certificate file Export CRL ./ 902 _export_crl . sh : < DER encoded CRL > Error code / description - What to do 9021 / Export CRL run successfully - no action needed 9022 / Export CRL failed (%s) - check manual with sh -x ./ 902 _export_crl . sh < crl > 9023 / Export CRL failed , script called without file - arg1 must be a DER encoded crl ! to run with output directed to screen : add a '-s' or '--screen' 903_make_hsm_backup.sh \u00b6 Scriptid : 903 - Nfast backup Backup a HSM Error code / description - What to do 9031 / Backup of Nfast HSM run successfully - no action needed 9032 / Backup of Nfast HSM failed (% s ) - TODO 9033 / - to run with output directed to screen : add a '-s' or '--screen' 904_make_mysql_db_backup.sh \u00b6 Scriptid : 904 - Mysql backup tool syntax : ./ 904 _make_mysql_db_backup . sh [- x |-- default |- d |-- daily |- w |-- weekly |- m |-- monthly |- y |-- yearly ] [- s |-- screen ] [- b |-- batch ] - x and -- default will put the backupfile in directory defined in config as SUBDIR_DEFAULT - d or -- daily will put the backup in the directory defined in config as SUBDIR_DAILY - w or -- weekly will put the backup in the directory defined in config as SUBDIR_WEEKLY - m or -- monthly will put the backup in the directory defined in config as SUBDIR_MONTHLY - y or -- yearly will put the backup in the directory defined in config as SUBDIR_YEARLY OBSERVE that it 's up to the admin to run this script with cron or alike at these intervals, so run this script once a day with --daily to get only one daily backup and so on -b or --batch will echo the resulting filename for processing by other scripts Error code / description - What to do 9041 / Backed up db ok file: %s time to complete(sec): %s filesize(bytes): %s - no action needed 9042 / Could not create the backup file: %s time to complete(sec): %s filesize(bytes): %s errormess: %s - Run manually also check disk space and owner of directory to write backup to 9043 / Backup failed, backupdir not found (%s) - check the configfile and make sure the configured directory exist to run with output directed to screen: add a ' - s ' or ' -- screen ' 905_publish_crl.sh \u00b6 Scriptid : 905 - CRL publish Script to publish the CRL : s from the CA , supports local and remote publishing by SSH Error code / description - What to do 9051 / Publish CRL run successfully (% s ) % s - No action needed 9052 / Publish to remote host failed crl :(% s ) host :(% s ) - Try manually to run this command and setup ssh - keys and check username 9053 / Publish CRL failed, can't copy crl to destination %s/ % s - Check permissions for the path : s to run with output directed to screen : add a '-s' or '--screen' 906_ssh-copy-to-remote-machine.sh \u00b6 Scriptid : 906 - SCP support tool Script used to copy files to other hosts /directorys usage: ./ 906 _ssh - copy - to - remote - machine . sh : file host < directory > < to - username > < from - ssh - key > ( if you dont specify directory the file will end up in the user 's homedirectory, if you dont specify to-username the same user as the one executing this script will be used, if from-ssh-key is not specified default key will be used) Error code / description - What to do 9061 / file transfered ok - ok 9062 / specify a filename as first argument to this script - filename not specified as argument 9063 / specify a hostname as second argument to this script - Hostname not specified as argument 9064 / scp failed: %s - check the error message and try to fix it 9065 / Diskspace at host: %s and dir: %s has to little space left %s , its lower than %s of the file: %s - Disk space on remote host to low 9066 / Remote filesize at host: %s and dir: %s has different size: %s than the original: %s of the file: %s - Remote filesize after transfer differs 9067 / Remote file already exist at host: %s remote file: %s for the local file: %s - Remote file already exist to run with output directed to screen: add a ' - s ' or ' -- screen ' 907_make_mysql_db_backup_and_transfer_to_remote_mashine.sh \u00b6 Scriptid : 907 - Mariadb backup and transfer to remote host Script used to take backup of the sql database , compress and send to a separate server . call with - x |-- default for puting the backupfile in the SUBDIR_DEFAULT ; - d |-- daily to make daily backup end up in SUBDIR_DAILY ; with - w |-- weekly to make daily backup end up in SUBDIR_WEEKLY ; - m |-- monthly to make daily backup end up in SUBDIR_MONTHLY ; - y |-- yearly to make daily backup end up in SUBDIR_YEARLY ; Error code / description - What to do 9071 / Backup and transfer was ok . - Ok 9072 / Could not get the backup from MySQL (% s ) - Could not make a backup . 9073 / Could not send the backup , maybe connection problem or problem logging in (% s ) - Could not send the backup . to run with output directed to screen : add a '-s' or '--screen' 908_clean_old_backups.sh \u00b6 Scriptid : 908 - Clean old backup files Clean old backups , so the disk dont fill up Error code / description - What to do 9081 / Clean backupfiles run successfully - All is ok 9082 / Clean backupfiles failed (% s ) - Unpredicted error while deleting file % s 9083 / Clean backupfile file did not exist (% s ) - Maybe the files has been already removed or there was no files from start 9084 / Datestring command did NOT return a valid string - try to run source lib/ libsyscheck . sh ; x - days - ago - datestr 3 to run with output directed to screen : add a '-s' or '--screen' 909_activate_CAs.sh \u00b6 Scriptid : 909 - Activate CA HSM Activate the CA : s ( automaticlly enter PIN codes ) Error code / description - What to do 9091 / Activate CA : s run successfully - All is ok 9092 / Activate CA failed (%s/ % s ) - Could be problems accessing the application server , or token is not available % s to run with output directed to screen : add a '-s' or '--screen' 910_deactivate_CAs.sh \u00b6 Scriptid : 910 - Deactivate CA HSM Deactivate the CA : s Error code / description - What to do 9101 / Deactivate CA : s run successfully - All is ok 9102 / Deactivate CA failed (% s ) - Could be problems accessing the application server , or token is not available % s to run with output directed to screen : add a '-s' or '--screen' 911_activate_VIP.sh \u00b6 Scriptid : 911 - Activate VIP Activate the VIP Error code / description - What to do 9111 / Activate VIP run successfully - All is ok 9112 / Activate VIP failed (% s ) - Manually try the ipconfig commands error :(% s ) 9113 / Activate VIP failed since the VIP was already active - All is ok , if the VIP was supposed to be on this host already 9114 / Activate VIP failed since the VIP was already active on another node - Check the other node to see if that node has the VIP , else start invesigating who has you IP ... to run with output directed to screen : add a '-s' or '--screen' 912_deactivate_VIP.sh \u00b6 Scriptid : 912 - Deactivate VIP Deactivate the VIP Error code / description - What to do 9121 / Deactivate VIP run successfully - All is ok 9122 / Deactivate VIP failed (% s ) - Check manually with ifconfig - a and run ifconfig < if > down 9123 / While deactivating , the VIP was already NOT active on this host - If the VIP was supposed to be at this host this event needs investigation to run with output directed to screen : add a '-s' or '--screen' 913_copy_ejbca_conf.sh \u00b6 Scriptid : 913 - Copy config to NODE2 Copy EJBCA conf /, p12/ and syscheck Error code / description - What to do 9131 / Copy run successfully - Check config and keys to remote hosts 9132 / Copy failed (% s ) - to run with output directed to screen : add a '-s' or '--screen' 914_compare_master_slave_db.sh \u00b6 Scriptid : 914 - Deactivate VIP Compare tables on master and slave database Error code / description - What to do 9141 / Data read successfully - All is ok 9142 / Could not get table data - Check connection , username and password to run with output directed to screen : add a '-s' or '--screen' 915_remote_command_via_ssh.sh \u00b6 Scriptid : 915 - SSH remote command tool Run command on another host with ssh ./ 915 _remote_command_via_ssh . sh -- host host -- command cmd -- user sshtouser -- key sshfromkey Error code / description - What to do 9151 / Command executed successfully (% s ) - All is ok 9152 / Host not found (% s ) - You have to specify a hostname to connect to 9153 / Command not found (% s ) - Specify a command to run 9154 / Command not executed (% s ) - Check connection , username and password to run with output directed to screen : add a '-s' or '--screen' 916_archive_access_manager_logs.sh \u00b6 Scriptid : 916 - Archive log files Script used to move / archive logfiles Error code / description - What to do 9161 / Files archived succefully (% s -> % s ) - ok 9162 / Failed to artchive files (% s -> % s ) - test the underlying archive script manually to run with output directed to screen : add a '-s' or '--screen' 917_archive_file.sh \u00b6 Scriptid : 917 - Archive files Script used to copy files to other hosts /directorys usage: ./ 917 _archive_file . sh : file host < directory > < to - username > < from - ssh - key > ( if you dont specify directory the file will end up in the user 's homedirectory, if you dont specify to-username the same user as the one executing this script will be used, if from-ssh-key is not specified default key will be used) Error code / description - What to do 9171 / File archived succefully Locally (%s -> %s) - ok 9172 / Failed to move file to Local archive (%s -> %s) - Check write premisions in archive dir 9173 / Errornous input arguments - specify the right arguments (run ./917_archive_file.sh -h for help) 9174 / Failed to get a filename from remote server - Check ssh connection setup to remote server 9175 / File Failed to be Archived on Remote Server (%s) - Check ssh connection setup to remote server and write permissions in remote archive dir 9176 / File Archived successfully to Remote Server (%s) - ok 9177 / File moved successfully to intransit folder (%s -> %s) - ok 9178 / Failed to create file in the intransit folder (%s) - Check permissions to write in the intransit folder 9179 / Intransit dir not found - Create the dir with mkdir to run with output directed to screen: add a ' - s ' or ' -- screen ' 918_server_alive.sh \u00b6 Scriptid : 918 - Passive server monitoring Passive server monitoring , all server that should be monitored should be listed in 918 . conf and run sc_19 . sh every x : th minute , example : if you run syscheck every 10 : th minute set warn to 15 ( missed one log and some margin ) and error to 25 ( missed one log and some margin ) Error code / description - What to do 9181 / machine (% s ) has called in as it 's supposed to (lastcall: %s). - no action is needed 9182 / machine(%s) has not called in within error limit (lastcall: %s) - two missed log messages, this needs attention 9183 / machine(%s) has not called in within warn limit (lastcall: %s) - one missed log message, may be a glitch but should be checked to run with output directed to screen: add a ' - s ' or ' -- screen ' 919_certpublisher_remotecommand.sh \u00b6 Scriptid : 919 - Certificate publishing remote host Takes a certificate and runs a configurable command at a remote host Error code / description - What to do 9191 / Remote command ran successfully (% s ) - no action needed 9192 / Remote command failed (% s ) - try to run the command manually 9193 / File input error , failed (% s ) - input file not set ok to run with output directed to screen : add a '-s' or '--screen' 920_restore_mysql_db_from_backup.sh \u00b6 Scriptid : 920 - DB Restore tool Restore db , syntax : ./ 920 _restore_mysql_db_from_backup . sh < gzip : ed mysqldump - file > Error code / description - What to do 9201 / Failed to make backup of the pre - existing db prior to restore - run a manual backup with arg - s to check errors 9202 / Restored the db from file (% s ) - no action needed 9203 / Failed to restore the db from the file (% s ) consider to restore to previously db (% s ) - to run with output directed to screen : add a '-s' or '--screen' 921_copy_htmf_conf.sh \u00b6 Scriptid : 921 - Copy HTMF config Copy HTMF config Error code / description - What to do 9211 / Interactive script to copy htmf / ejbca config - files are added in config file to run with output directed to screen : add a '-s' or '--screen' 922-simple-database-replication-check.sh \u00b6 Scriptid : 922 - Simple db replication tool Simple replication test Error code / description - What to do 9221 / Value replicated ok - ok , no action needed 9222 / Value differs - databse not replicating (% s != % s ), manually check the database with check master and check slave script 9223 / No value from node2 (% s ) - check connection manually , ping , telnet , mysql - h node2 - u dbadmin - p ... 9224 / No value from node1 (% s ) - check connection manually , ping , telnet , mysql - h node1 - u dbadmin - p ... to run with output directed to screen : add a '-s' or '--screen' 923-rsync-to-remote-machine.sh \u00b6 Scriptid : 923 - Sync files to remote host Script used to sync files with rsync to other hosts /directorys usage: ./ 923 - rsync - to - remote - machine . sh : file host < directory > < to - username > < from - ssh - key > ( if you dont specify directory the file will end up in the user 's homedirectory, if you dont specify to-username the same user as the one executing this script will be used, if from-ssh-key is not specified default key will be used) Error code / description - What to do 9231 / file transfered ok - ok 9232 / specify a filename as first argument to this script - filename not specified as argument 9233 / specify a hostname as second argument to this script - Hostname not specified as argument 9234 / rsync transfer failed (%s) - check the error message and try to fix it to run with output directed to screen: add a ' - s ' or ' -- screen ' 924-backup-this-machine-to-remote-machine.sh \u00b6 Scriptid : 924 - Sync several directories and files to remote host Script used to rsync configured files / dirs to other hosts Error code / description - What to do 9241 / file transfered ok - ok 9242 / Could not find transfer script - The underlying script for making the transfers SYSCHECK_HOME/related-enabled/ 923 - rsync - to - remote - machine . sh dont exist , read docs for guide howto enable it 9243 / Failed to sync files (%s) - check the config and run SYSCHECK_HOME/related-enabled/ 923 - rsync - to - remote - machine . sh manually with the same options to run with output directed to screen : add a '-s' or '--screen' 925_publish_crl_from_file.sh \u00b6 Scriptid : 925 - Publish a CRL from a file Publish a CRL from file , ie you need to call this script with the file on disc ./ 925 _publish_crl_from_file . sh : - c < file >|-- crlfile =< file > Error code / description - What to do 9251 / Publish crl run successfully - ok 9252 / no input file found - supply file as argument to this script 9253 / Publish certificate failed , cant read file (% s ) - verify the file is in place and with proper permissions before executing this script to run with output directed to screen : add a '-s' or '--screen' 926_local_htmf_copy_conf.sh \u00b6 Scriptid : 926 - Locally copy config and keystores Copy all config /keystore files to /tmp/ bckup_htmf_conf before system upgrade Error code / description - What to do 9261 / File copied ok (% s ) - no action needed 9262 / Failed to copy file (% s ) - check permissions and paths 9263 / Failed to create backup dir (% s ) - check permissions and paths to run with output directed to screen : add a '-s' or '--screen' 927_create_crls.sh \u00b6 Scriptid : 927 - Trigger the Creation of CRLs in EJBCA Script to create the CRL : s from the CA : s options if needed Error code / description - What to do 9271 / Create CRL run successfully (% s ) - No action needed 9272 / Create CRL failed (%s) - Try manually to run this command or direct do 'cd /opt/ejbca ; ./bin/ ejbca . sh ca createcrl ' 9273 / - to run with output directed to screen: add a ' - s ' or ' -- screen ' 928_check_dsm_backup.sh \u00b6 Scriptid : 928 - DSM Backup Check if DSM Backup working Error code / description - What to do 9281 / DSM Backup ok ( file :% s result :% s ) - no action needed 9282 / DSM Backup failed file :% s result :% s - Check DSM tool for troubleshooting 9283 / - to run with output directed to screen : add a '-s' or '--screen' 929_filter_syscheck_messages.sh \u00b6 Scriptid : 929 - Filter messages from syscheck Filter only some messages from a file Error code / description - What to do 9291 / Filter ok - no action needed 9292 / Filter failed - try the commands manually to run with output directed to screen : add a '-s' or '--screen' 930_send_filtered_result_to_remote_machine.sh \u00b6 Scriptid : 930 - Send files to remote host Copy a file over to a central hub ( might be used to expose some or all of syscheck results ) Error code / description - What to do 9301 / Transfer ok ( file :% s result :% s ) - no action needed 9302 / Could not transfer file :% s result :% s - try the transfer commands manually 9303 / - to run with output directed to screen : add a '-s' or '--screen' 931_mysql_backup_encrypt_send_to_remote_host.sh \u00b6 Scriptid : 931 - Backup , encrypt backup and send to remote hosts Script used to take backup of the sql database , compress and send to a separate server . call with - x |-- default for puting the backupfile in the SUBDIR_DEFAULT ; - d |-- daily to make daily backup end up in SUBDIR_DAILY ; with - w |-- weekly to make daily backup end up in SUBDIR_WEEKLY ; - m |-- monthly to make daily backup end up in SUBDIR_MONTHLY ; - y |-- yearly to make daily backup end up in SUBDIR_YEARLY ; Error code / description - What to do 9311 / Backup and transfer was ok . (% s ) - Ok 9312 / Could not get the backup from MySQL (% s ) - Could not make a backup . 9313 / Compression of the backup failed (% s ) - Could not compress the backup . to run with output directed to screen : add a '-s' or '--screen' 932_send_result_as_message.sh \u00b6 Scriptid : 932 - Send result as a message Send syscheck result as a message over to a central hub Error code / description - What to do 9321 / Transfer ok ( command :% s result :% s ) - no action needed 9322 / Could not send message : % s result :% s - try the transfer commands manually to run with output directed to screen : add a '-s' or '--screen' 933_select_from_database.sh \u00b6 Scriptid : 933 - Select from db for info Get info from db Error code / description - What to do 9331 / Selected info from DB ( command :% s ) - no action needed 9332 / Could not get info from db : % s - try the commands manually to run with output directed to screen : add a '-s' or '--screen' 934_check_validity_of_installed_certs.sh \u00b6 Scriptid : 934 - Certificate validity check Monitor certificates validity Error code / description - What to do 9341 / File : % s subj : % s days until expiry : % s - no action needed 9342 / File : % s subj : % s days until expiry : % s - schedule replacement soon 9343 / File : % s subj : % s days until expiry : % s - Certificate indicent is close to run with output directed to screen : add a '-s' or '--screen' 935_mysql_console_as_root.sh \u00b6 Scriptid : 935 - Start mysql as root as a convenience tool Error code / description - What to do 9351 / - 9352 / - 9353 / - to run with output directed to screen : add a '-s' or '--screen' 936_mysql_console_as_db_user.sh \u00b6 Scriptid : 936 - Start mysql as dbuser as a convenience tool Error code / description - What to do to run with output directed to screen : add a '-s' or '--screen' 937_delete_old_CRLData.sh \u00b6 Scriptid : 937 - Delete old records from CRL Data Delete records from crldata , keep default 20 record in crltable , see config file 817 . conf Error code / description - What to do 9371 / No Value in ROW_SAVE - Check scripts config file 9372 / The value is less then 5 - Check scripts config file 9373 / Can 't make a backup - Check permisson and dbuser 9374 / Can' t get uniq issuerDN from CRLData - Check database and logs 9375 / Can 't copy CRLData to db crldata.CRLDatalog for each issuerDN - Check database and logs 9376 / Cant delete record from CRLData for uniq issuerDN - Check database and logs 9377 / Delete to crlnumber - Delet ok 9378 / Can' t Optimize table - Check vendor of database , and adjust command 9379 / Can 't zip dbbackup - Check permission 93710 / Delete to crlnumber, restart jboss and check sync - Delete ok to run with output directed to screen: add a ' - s ' or ' -- screen '","title":"Related Scripts"},{"location":"related-scripts/#syscheck-version-20","text":"Documentation generated: Mon 10 Aug 00:13:14 CEST 2020","title":"Syscheck version 2.0"},{"location":"related-scripts/#syscheck-related-scripts","text":"","title":"Syscheck related scripts"},{"location":"related-scripts/#900_export_certsh","text":"Scriptid : 900 - Export certificate file Export certificate and archive them , ./ 900 _export_cert . sh < certfile > Error code / description - What to do 9001 / Export certificate run successfully - no actions needed 9002 / Export certificate failed (% s ) - Unexpected , run the script with sh - x to check 9003 / Export certificate failed , script called without file - call this script with a PEM encoded certficate as arg1 to run with output directed to screen : add a '-s' or '--screen'","title":"900_export_cert.sh"},{"location":"related-scripts/#901_export_revocationsh","text":"Scriptid : 901 - Export CRL file Export CRL : s with a script ./ 901 _export_revocation . sh < DER - encoded CERT > Error code / description - What to do 9011 / Export revocation run successfully - no actions needed 9012 / Export revocation failed (%s) - check manually with sh -x ./ 901 _export_revocation . sh < file > 9013 / Export revocation failed , script called without file - call this script with a DER encoded CERT as arg1 to run with output directed to screen : add a '-s' or '--screen'","title":"901_export_revocation.sh"},{"location":"related-scripts/#902_export_crlsh","text":"Scriptid : 902 - Export revoked certificate file Export CRL ./ 902 _export_crl . sh : < DER encoded CRL > Error code / description - What to do 9021 / Export CRL run successfully - no action needed 9022 / Export CRL failed (%s) - check manual with sh -x ./ 902 _export_crl . sh < crl > 9023 / Export CRL failed , script called without file - arg1 must be a DER encoded crl ! to run with output directed to screen : add a '-s' or '--screen'","title":"902_export_crl.sh"},{"location":"related-scripts/#903_make_hsm_backupsh","text":"Scriptid : 903 - Nfast backup Backup a HSM Error code / description - What to do 9031 / Backup of Nfast HSM run successfully - no action needed 9032 / Backup of Nfast HSM failed (% s ) - TODO 9033 / - to run with output directed to screen : add a '-s' or '--screen'","title":"903_make_hsm_backup.sh"},{"location":"related-scripts/#904_make_mysql_db_backupsh","text":"Scriptid : 904 - Mysql backup tool syntax : ./ 904 _make_mysql_db_backup . sh [- x |-- default |- d |-- daily |- w |-- weekly |- m |-- monthly |- y |-- yearly ] [- s |-- screen ] [- b |-- batch ] - x and -- default will put the backupfile in directory defined in config as SUBDIR_DEFAULT - d or -- daily will put the backup in the directory defined in config as SUBDIR_DAILY - w or -- weekly will put the backup in the directory defined in config as SUBDIR_WEEKLY - m or -- monthly will put the backup in the directory defined in config as SUBDIR_MONTHLY - y or -- yearly will put the backup in the directory defined in config as SUBDIR_YEARLY OBSERVE that it 's up to the admin to run this script with cron or alike at these intervals, so run this script once a day with --daily to get only one daily backup and so on -b or --batch will echo the resulting filename for processing by other scripts Error code / description - What to do 9041 / Backed up db ok file: %s time to complete(sec): %s filesize(bytes): %s - no action needed 9042 / Could not create the backup file: %s time to complete(sec): %s filesize(bytes): %s errormess: %s - Run manually also check disk space and owner of directory to write backup to 9043 / Backup failed, backupdir not found (%s) - check the configfile and make sure the configured directory exist to run with output directed to screen: add a ' - s ' or ' -- screen '","title":"904_make_mysql_db_backup.sh"},{"location":"related-scripts/#905_publish_crlsh","text":"Scriptid : 905 - CRL publish Script to publish the CRL : s from the CA , supports local and remote publishing by SSH Error code / description - What to do 9051 / Publish CRL run successfully (% s ) % s - No action needed 9052 / Publish to remote host failed crl :(% s ) host :(% s ) - Try manually to run this command and setup ssh - keys and check username 9053 / Publish CRL failed, can't copy crl to destination %s/ % s - Check permissions for the path : s to run with output directed to screen : add a '-s' or '--screen'","title":"905_publish_crl.sh"},{"location":"related-scripts/#906_ssh-copy-to-remote-machinesh","text":"Scriptid : 906 - SCP support tool Script used to copy files to other hosts /directorys usage: ./ 906 _ssh - copy - to - remote - machine . sh : file host < directory > < to - username > < from - ssh - key > ( if you dont specify directory the file will end up in the user 's homedirectory, if you dont specify to-username the same user as the one executing this script will be used, if from-ssh-key is not specified default key will be used) Error code / description - What to do 9061 / file transfered ok - ok 9062 / specify a filename as first argument to this script - filename not specified as argument 9063 / specify a hostname as second argument to this script - Hostname not specified as argument 9064 / scp failed: %s - check the error message and try to fix it 9065 / Diskspace at host: %s and dir: %s has to little space left %s , its lower than %s of the file: %s - Disk space on remote host to low 9066 / Remote filesize at host: %s and dir: %s has different size: %s than the original: %s of the file: %s - Remote filesize after transfer differs 9067 / Remote file already exist at host: %s remote file: %s for the local file: %s - Remote file already exist to run with output directed to screen: add a ' - s ' or ' -- screen '","title":"906_ssh-copy-to-remote-machine.sh"},{"location":"related-scripts/#907_make_mysql_db_backup_and_transfer_to_remote_mashinesh","text":"Scriptid : 907 - Mariadb backup and transfer to remote host Script used to take backup of the sql database , compress and send to a separate server . call with - x |-- default for puting the backupfile in the SUBDIR_DEFAULT ; - d |-- daily to make daily backup end up in SUBDIR_DAILY ; with - w |-- weekly to make daily backup end up in SUBDIR_WEEKLY ; - m |-- monthly to make daily backup end up in SUBDIR_MONTHLY ; - y |-- yearly to make daily backup end up in SUBDIR_YEARLY ; Error code / description - What to do 9071 / Backup and transfer was ok . - Ok 9072 / Could not get the backup from MySQL (% s ) - Could not make a backup . 9073 / Could not send the backup , maybe connection problem or problem logging in (% s ) - Could not send the backup . to run with output directed to screen : add a '-s' or '--screen'","title":"907_make_mysql_db_backup_and_transfer_to_remote_mashine.sh"},{"location":"related-scripts/#908_clean_old_backupssh","text":"Scriptid : 908 - Clean old backup files Clean old backups , so the disk dont fill up Error code / description - What to do 9081 / Clean backupfiles run successfully - All is ok 9082 / Clean backupfiles failed (% s ) - Unpredicted error while deleting file % s 9083 / Clean backupfile file did not exist (% s ) - Maybe the files has been already removed or there was no files from start 9084 / Datestring command did NOT return a valid string - try to run source lib/ libsyscheck . sh ; x - days - ago - datestr 3 to run with output directed to screen : add a '-s' or '--screen'","title":"908_clean_old_backups.sh"},{"location":"related-scripts/#909_activate_cassh","text":"Scriptid : 909 - Activate CA HSM Activate the CA : s ( automaticlly enter PIN codes ) Error code / description - What to do 9091 / Activate CA : s run successfully - All is ok 9092 / Activate CA failed (%s/ % s ) - Could be problems accessing the application server , or token is not available % s to run with output directed to screen : add a '-s' or '--screen'","title":"909_activate_CAs.sh"},{"location":"related-scripts/#910_deactivate_cassh","text":"Scriptid : 910 - Deactivate CA HSM Deactivate the CA : s Error code / description - What to do 9101 / Deactivate CA : s run successfully - All is ok 9102 / Deactivate CA failed (% s ) - Could be problems accessing the application server , or token is not available % s to run with output directed to screen : add a '-s' or '--screen'","title":"910_deactivate_CAs.sh"},{"location":"related-scripts/#911_activate_vipsh","text":"Scriptid : 911 - Activate VIP Activate the VIP Error code / description - What to do 9111 / Activate VIP run successfully - All is ok 9112 / Activate VIP failed (% s ) - Manually try the ipconfig commands error :(% s ) 9113 / Activate VIP failed since the VIP was already active - All is ok , if the VIP was supposed to be on this host already 9114 / Activate VIP failed since the VIP was already active on another node - Check the other node to see if that node has the VIP , else start invesigating who has you IP ... to run with output directed to screen : add a '-s' or '--screen'","title":"911_activate_VIP.sh"},{"location":"related-scripts/#912_deactivate_vipsh","text":"Scriptid : 912 - Deactivate VIP Deactivate the VIP Error code / description - What to do 9121 / Deactivate VIP run successfully - All is ok 9122 / Deactivate VIP failed (% s ) - Check manually with ifconfig - a and run ifconfig < if > down 9123 / While deactivating , the VIP was already NOT active on this host - If the VIP was supposed to be at this host this event needs investigation to run with output directed to screen : add a '-s' or '--screen'","title":"912_deactivate_VIP.sh"},{"location":"related-scripts/#913_copy_ejbca_confsh","text":"Scriptid : 913 - Copy config to NODE2 Copy EJBCA conf /, p12/ and syscheck Error code / description - What to do 9131 / Copy run successfully - Check config and keys to remote hosts 9132 / Copy failed (% s ) - to run with output directed to screen : add a '-s' or '--screen'","title":"913_copy_ejbca_conf.sh"},{"location":"related-scripts/#914_compare_master_slave_dbsh","text":"Scriptid : 914 - Deactivate VIP Compare tables on master and slave database Error code / description - What to do 9141 / Data read successfully - All is ok 9142 / Could not get table data - Check connection , username and password to run with output directed to screen : add a '-s' or '--screen'","title":"914_compare_master_slave_db.sh"},{"location":"related-scripts/#915_remote_command_via_sshsh","text":"Scriptid : 915 - SSH remote command tool Run command on another host with ssh ./ 915 _remote_command_via_ssh . sh -- host host -- command cmd -- user sshtouser -- key sshfromkey Error code / description - What to do 9151 / Command executed successfully (% s ) - All is ok 9152 / Host not found (% s ) - You have to specify a hostname to connect to 9153 / Command not found (% s ) - Specify a command to run 9154 / Command not executed (% s ) - Check connection , username and password to run with output directed to screen : add a '-s' or '--screen'","title":"915_remote_command_via_ssh.sh"},{"location":"related-scripts/#916_archive_access_manager_logssh","text":"Scriptid : 916 - Archive log files Script used to move / archive logfiles Error code / description - What to do 9161 / Files archived succefully (% s -> % s ) - ok 9162 / Failed to artchive files (% s -> % s ) - test the underlying archive script manually to run with output directed to screen : add a '-s' or '--screen'","title":"916_archive_access_manager_logs.sh"},{"location":"related-scripts/#917_archive_filesh","text":"Scriptid : 917 - Archive files Script used to copy files to other hosts /directorys usage: ./ 917 _archive_file . sh : file host < directory > < to - username > < from - ssh - key > ( if you dont specify directory the file will end up in the user 's homedirectory, if you dont specify to-username the same user as the one executing this script will be used, if from-ssh-key is not specified default key will be used) Error code / description - What to do 9171 / File archived succefully Locally (%s -> %s) - ok 9172 / Failed to move file to Local archive (%s -> %s) - Check write premisions in archive dir 9173 / Errornous input arguments - specify the right arguments (run ./917_archive_file.sh -h for help) 9174 / Failed to get a filename from remote server - Check ssh connection setup to remote server 9175 / File Failed to be Archived on Remote Server (%s) - Check ssh connection setup to remote server and write permissions in remote archive dir 9176 / File Archived successfully to Remote Server (%s) - ok 9177 / File moved successfully to intransit folder (%s -> %s) - ok 9178 / Failed to create file in the intransit folder (%s) - Check permissions to write in the intransit folder 9179 / Intransit dir not found - Create the dir with mkdir to run with output directed to screen: add a ' - s ' or ' -- screen '","title":"917_archive_file.sh"},{"location":"related-scripts/#918_server_alivesh","text":"Scriptid : 918 - Passive server monitoring Passive server monitoring , all server that should be monitored should be listed in 918 . conf and run sc_19 . sh every x : th minute , example : if you run syscheck every 10 : th minute set warn to 15 ( missed one log and some margin ) and error to 25 ( missed one log and some margin ) Error code / description - What to do 9181 / machine (% s ) has called in as it 's supposed to (lastcall: %s). - no action is needed 9182 / machine(%s) has not called in within error limit (lastcall: %s) - two missed log messages, this needs attention 9183 / machine(%s) has not called in within warn limit (lastcall: %s) - one missed log message, may be a glitch but should be checked to run with output directed to screen: add a ' - s ' or ' -- screen '","title":"918_server_alive.sh"},{"location":"related-scripts/#919_certpublisher_remotecommandsh","text":"Scriptid : 919 - Certificate publishing remote host Takes a certificate and runs a configurable command at a remote host Error code / description - What to do 9191 / Remote command ran successfully (% s ) - no action needed 9192 / Remote command failed (% s ) - try to run the command manually 9193 / File input error , failed (% s ) - input file not set ok to run with output directed to screen : add a '-s' or '--screen'","title":"919_certpublisher_remotecommand.sh"},{"location":"related-scripts/#920_restore_mysql_db_from_backupsh","text":"Scriptid : 920 - DB Restore tool Restore db , syntax : ./ 920 _restore_mysql_db_from_backup . sh < gzip : ed mysqldump - file > Error code / description - What to do 9201 / Failed to make backup of the pre - existing db prior to restore - run a manual backup with arg - s to check errors 9202 / Restored the db from file (% s ) - no action needed 9203 / Failed to restore the db from the file (% s ) consider to restore to previously db (% s ) - to run with output directed to screen : add a '-s' or '--screen'","title":"920_restore_mysql_db_from_backup.sh"},{"location":"related-scripts/#921_copy_htmf_confsh","text":"Scriptid : 921 - Copy HTMF config Copy HTMF config Error code / description - What to do 9211 / Interactive script to copy htmf / ejbca config - files are added in config file to run with output directed to screen : add a '-s' or '--screen'","title":"921_copy_htmf_conf.sh"},{"location":"related-scripts/#922-simple-database-replication-checksh","text":"Scriptid : 922 - Simple db replication tool Simple replication test Error code / description - What to do 9221 / Value replicated ok - ok , no action needed 9222 / Value differs - databse not replicating (% s != % s ), manually check the database with check master and check slave script 9223 / No value from node2 (% s ) - check connection manually , ping , telnet , mysql - h node2 - u dbadmin - p ... 9224 / No value from node1 (% s ) - check connection manually , ping , telnet , mysql - h node1 - u dbadmin - p ... to run with output directed to screen : add a '-s' or '--screen'","title":"922-simple-database-replication-check.sh"},{"location":"related-scripts/#923-rsync-to-remote-machinesh","text":"Scriptid : 923 - Sync files to remote host Script used to sync files with rsync to other hosts /directorys usage: ./ 923 - rsync - to - remote - machine . sh : file host < directory > < to - username > < from - ssh - key > ( if you dont specify directory the file will end up in the user 's homedirectory, if you dont specify to-username the same user as the one executing this script will be used, if from-ssh-key is not specified default key will be used) Error code / description - What to do 9231 / file transfered ok - ok 9232 / specify a filename as first argument to this script - filename not specified as argument 9233 / specify a hostname as second argument to this script - Hostname not specified as argument 9234 / rsync transfer failed (%s) - check the error message and try to fix it to run with output directed to screen: add a ' - s ' or ' -- screen '","title":"923-rsync-to-remote-machine.sh"},{"location":"related-scripts/#924-backup-this-machine-to-remote-machinesh","text":"Scriptid : 924 - Sync several directories and files to remote host Script used to rsync configured files / dirs to other hosts Error code / description - What to do 9241 / file transfered ok - ok 9242 / Could not find transfer script - The underlying script for making the transfers SYSCHECK_HOME/related-enabled/ 923 - rsync - to - remote - machine . sh dont exist , read docs for guide howto enable it 9243 / Failed to sync files (%s) - check the config and run SYSCHECK_HOME/related-enabled/ 923 - rsync - to - remote - machine . sh manually with the same options to run with output directed to screen : add a '-s' or '--screen'","title":"924-backup-this-machine-to-remote-machine.sh"},{"location":"related-scripts/#925_publish_crl_from_filesh","text":"Scriptid : 925 - Publish a CRL from a file Publish a CRL from file , ie you need to call this script with the file on disc ./ 925 _publish_crl_from_file . sh : - c < file >|-- crlfile =< file > Error code / description - What to do 9251 / Publish crl run successfully - ok 9252 / no input file found - supply file as argument to this script 9253 / Publish certificate failed , cant read file (% s ) - verify the file is in place and with proper permissions before executing this script to run with output directed to screen : add a '-s' or '--screen'","title":"925_publish_crl_from_file.sh"},{"location":"related-scripts/#926_local_htmf_copy_confsh","text":"Scriptid : 926 - Locally copy config and keystores Copy all config /keystore files to /tmp/ bckup_htmf_conf before system upgrade Error code / description - What to do 9261 / File copied ok (% s ) - no action needed 9262 / Failed to copy file (% s ) - check permissions and paths 9263 / Failed to create backup dir (% s ) - check permissions and paths to run with output directed to screen : add a '-s' or '--screen'","title":"926_local_htmf_copy_conf.sh"},{"location":"related-scripts/#927_create_crlssh","text":"Scriptid : 927 - Trigger the Creation of CRLs in EJBCA Script to create the CRL : s from the CA : s options if needed Error code / description - What to do 9271 / Create CRL run successfully (% s ) - No action needed 9272 / Create CRL failed (%s) - Try manually to run this command or direct do 'cd /opt/ejbca ; ./bin/ ejbca . sh ca createcrl ' 9273 / - to run with output directed to screen: add a ' - s ' or ' -- screen '","title":"927_create_crls.sh"},{"location":"related-scripts/#928_check_dsm_backupsh","text":"Scriptid : 928 - DSM Backup Check if DSM Backup working Error code / description - What to do 9281 / DSM Backup ok ( file :% s result :% s ) - no action needed 9282 / DSM Backup failed file :% s result :% s - Check DSM tool for troubleshooting 9283 / - to run with output directed to screen : add a '-s' or '--screen'","title":"928_check_dsm_backup.sh"},{"location":"related-scripts/#929_filter_syscheck_messagessh","text":"Scriptid : 929 - Filter messages from syscheck Filter only some messages from a file Error code / description - What to do 9291 / Filter ok - no action needed 9292 / Filter failed - try the commands manually to run with output directed to screen : add a '-s' or '--screen'","title":"929_filter_syscheck_messages.sh"},{"location":"related-scripts/#930_send_filtered_result_to_remote_machinesh","text":"Scriptid : 930 - Send files to remote host Copy a file over to a central hub ( might be used to expose some or all of syscheck results ) Error code / description - What to do 9301 / Transfer ok ( file :% s result :% s ) - no action needed 9302 / Could not transfer file :% s result :% s - try the transfer commands manually 9303 / - to run with output directed to screen : add a '-s' or '--screen'","title":"930_send_filtered_result_to_remote_machine.sh"},{"location":"related-scripts/#931_mysql_backup_encrypt_send_to_remote_hostsh","text":"Scriptid : 931 - Backup , encrypt backup and send to remote hosts Script used to take backup of the sql database , compress and send to a separate server . call with - x |-- default for puting the backupfile in the SUBDIR_DEFAULT ; - d |-- daily to make daily backup end up in SUBDIR_DAILY ; with - w |-- weekly to make daily backup end up in SUBDIR_WEEKLY ; - m |-- monthly to make daily backup end up in SUBDIR_MONTHLY ; - y |-- yearly to make daily backup end up in SUBDIR_YEARLY ; Error code / description - What to do 9311 / Backup and transfer was ok . (% s ) - Ok 9312 / Could not get the backup from MySQL (% s ) - Could not make a backup . 9313 / Compression of the backup failed (% s ) - Could not compress the backup . to run with output directed to screen : add a '-s' or '--screen'","title":"931_mysql_backup_encrypt_send_to_remote_host.sh"},{"location":"related-scripts/#932_send_result_as_messagesh","text":"Scriptid : 932 - Send result as a message Send syscheck result as a message over to a central hub Error code / description - What to do 9321 / Transfer ok ( command :% s result :% s ) - no action needed 9322 / Could not send message : % s result :% s - try the transfer commands manually to run with output directed to screen : add a '-s' or '--screen'","title":"932_send_result_as_message.sh"},{"location":"related-scripts/#933_select_from_databasesh","text":"Scriptid : 933 - Select from db for info Get info from db Error code / description - What to do 9331 / Selected info from DB ( command :% s ) - no action needed 9332 / Could not get info from db : % s - try the commands manually to run with output directed to screen : add a '-s' or '--screen'","title":"933_select_from_database.sh"},{"location":"related-scripts/#934_check_validity_of_installed_certssh","text":"Scriptid : 934 - Certificate validity check Monitor certificates validity Error code / description - What to do 9341 / File : % s subj : % s days until expiry : % s - no action needed 9342 / File : % s subj : % s days until expiry : % s - schedule replacement soon 9343 / File : % s subj : % s days until expiry : % s - Certificate indicent is close to run with output directed to screen : add a '-s' or '--screen'","title":"934_check_validity_of_installed_certs.sh"},{"location":"related-scripts/#935_mysql_console_as_rootsh","text":"Scriptid : 935 - Start mysql as root as a convenience tool Error code / description - What to do 9351 / - 9352 / - 9353 / - to run with output directed to screen : add a '-s' or '--screen'","title":"935_mysql_console_as_root.sh"},{"location":"related-scripts/#936_mysql_console_as_db_usersh","text":"Scriptid : 936 - Start mysql as dbuser as a convenience tool Error code / description - What to do to run with output directed to screen : add a '-s' or '--screen'","title":"936_mysql_console_as_db_user.sh"},{"location":"related-scripts/#937_delete_old_crldatash","text":"Scriptid : 937 - Delete old records from CRL Data Delete records from crldata , keep default 20 record in crltable , see config file 817 . conf Error code / description - What to do 9371 / No Value in ROW_SAVE - Check scripts config file 9372 / The value is less then 5 - Check scripts config file 9373 / Can 't make a backup - Check permisson and dbuser 9374 / Can' t get uniq issuerDN from CRLData - Check database and logs 9375 / Can 't copy CRLData to db crldata.CRLDatalog for each issuerDN - Check database and logs 9376 / Cant delete record from CRLData for uniq issuerDN - Check database and logs 9377 / Delete to crlnumber - Delet ok 9378 / Can' t Optimize table - Check vendor of database , and adjust command 9379 / Can 't zip dbbackup - Check permission 93710 / Delete to crlnumber, restart jboss and check sync - Delete ok to run with output directed to screen: add a ' - s ' or ' -- screen '","title":"937_delete_old_CRLData.sh"},{"location":"ssh-keys-setup/","text":"Syscheck - LOGBOOK Tool \u00b6 Changes \u00b6 Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates SSH Keys Installation \u00b6 This chapter assumes that your application user is called \u201cjboss\u201d. The purpose of the installation of ssh-keys is to automaticly be able to run commands on the other node in a cluster. 3.1 Generate keys on both nodes on node1 run: username@smartcard20-node1:/usr/local> sudo su - jboss jobss@smartcard20-node1:~> ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/jboss/.ssh/id_rsa): Created directory '/home/jboss/.ssh'. Enter passphrase (empty for no passphrase): (press enter to use no passphrase) Enter same passphrase again: Your identification has been saved in /home/jboss/.ssh/id_rsa. Your public key has been saved in /home/jboss/.ssh/id_rsa.pub. And also on all the other nodes run: username@smartcard20-node2:/usr/local> sudo su - jboss jobss@smartcard20-node2:~> ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/jboss/.ssh/id_rsa): Created directory '/home/jboss/.ssh'. Enter passphrase (empty for no passphrase): (press enter to use no passphrase) Enter same passphrase again: Your identification has been saved in /home/jboss/.ssh/id_rsa. Your public key has been saved in /home/jboss/.ssh/id_rsa.pub. Add the own public key to the own authorized_keys to allow local ssh jboss@smartcard20-node1:~> cp .ssh/id_rsa.pub .ssh/authorized_keys jboss@smartcard20-node1:~> ssh localhost The authenticity of host 'localhost (127.0.0.1)' can't be established. RSA key fingerprint is 73:c8:8f:20:73:83:62:c7:5e:a0:7d:cb:38:c8:04:43. Are you sure you want to continue connecting (yes/no)? yes Warning: Permanently added 'localhost' (RSA) to the list of known hosts. jboss@smartcard20-node1:~> logout on node2 run: jboss@smartcard20-node2:~> cp .ssh/id_rsa.pub .ssh/authorized_keys jboss@smartcard20-node2:~> ssh localhost The authenticity of host 'localhost (127.0.0.1)' can't be established. RSA key fingerprint is 73:c8:8f:20:73:83:62:c7:5e:a0:7d:cb:38:c8:04:43. Are you sure you want to continue connecting (yes/no)? yes Warning: Permanently added 'localhost' (RSA) to the list of known hosts. jboss@smartcard20-node2:~> logout Add node1 public key to node2 authorized_keys to allow ssh from node1 to node2 on node1 run: jboss@smartcard20-node1:~> cat .ssh/id_rsa.pub ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node1 on node2 run: jboss@smartcard20-node2:~> vi .ssh/authorized_keys ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node2 To add a new line below the only line in authorized_keys press \u201co\u201d then paste the key from node1 press escape to exit edit mode make sure that the new key is on one line only, press \u201cJ\u201d to join to lines if the line broke in copy-and-paste, delete space with \u201cx\u201d press :wq to exit Change the window size so any line-wraps problem reveals it self. Make sure each key is on one line on node2 run: jboss@smartcard20-node2:~> cat .ssh/authorized_keys ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node2 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEArzafoK1mzu0WYr1c0I8efdkOE5+58ccM83fJ32EuUxKfrvEi3GsJKyZPvuSZr4VXUgRvyyWzg8JtwJR7s+8NSqcHhdeN+zeVQx9/YCw8xOQLx9SOORato76WfwhjM7kUrZd/bIQQGRDwh1rvCVRlNr7kFFRsEe+afxP42AZkZaD6bCBsG4BF/iR5+YCERzuUymrN5g8qWU5Hw1Hegedz+7oCJZ8FO3UVB6SREDA1n4c651gWa+xtx+5KgWLcfQU8V019fzuVz45c1mF0r0zQF4Z66gq/HEkYUjttk7hgCrRaeIR1GTu+9HNF2+aSV44ZqKtd5L1cX1xsxJCJijjnSw== han@smartcard20-node1 jboss@smartcard20-node2:~> wc -l .ssh/authorized_keys 2 .ssh/authorized_keys verify ssh access to the other node: jboss@smartcard20-node1:~> ssh jboss@smartcard20-node2 Last login: Sat Jun 5 08:41:53 2010 from localhost jboss@smartcard20-node2:~> Add node2 public key to node1 authorized_keys to allow ssh from node2 to node1 on node2 run: jboss@smartcard20-node2:~> cat .ssh/id_rsa.pub ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node2 on node1 run: jboss@smartcard20-node1:~> vi .ssh/authorized_keys ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node1 To add a new line below the only line in authorized_keys press \u201co\u201d then paste the key from node2 press escape to exit edit mode make sure that the new key is on one line only, press \u201cJ\u201d to join to lines if the line broke in copy-and-paste, delete space with \u201cx\u201d press :wq to exit Change the window size so any line-wraps problem reveals it self. Make sure each key is on one line on node2 run: jboss@smartcard20-node1:~> cat .ssh/authorized_keys ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node1 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEArzafoK1mzu0WYr1c0I8efdkOE5+58ccM83fJ32EuUxKfrvEi3GsJKyZPvuSZr4VXUgRvyyWzg8JtwJR7s+8NSqcHhdeN+zeVQx9/YCw8xOQLx9SOORato76WfwhjM7kUrZd/bIQQGRDwh1rvCVRlNr7kFFRsEe+afxP42AZkZaD6bCBsG4BF/iR5+YCERzuUymrN5g8qWU5Hw1Hegedz+7oCJZ8FO3UVB6SREDA1n4c651gWa+xtx+5KgWLcfQU8V019fzuVz45c1mF0r0zQF4Z66gq/HEkYUjttk7hgCrRaeIR1GTu+9HNF2+aSV44ZqKtd5L1cX1xsxJCJijjnSw== han@smartcard20-node2 jboss@smartcard20-node2:~> wc -l .ssh/authorized_keys 2 .ssh/authorized_keys verify ssh access to the other node: jboss@smartcard20-node2:~> ssh smartcard20-node1 Last login: Sat Jun 5 08:41:53 2010 from localhost jboss@smartcard20-node1:~>","title":"SSH Keys"},{"location":"ssh-keys-setup/#syscheck-logbook-tool","text":"","title":"Syscheck - LOGBOOK Tool"},{"location":"ssh-keys-setup/#changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates","title":"Changes"},{"location":"ssh-keys-setup/#ssh-keys-installation","text":"This chapter assumes that your application user is called \u201cjboss\u201d. The purpose of the installation of ssh-keys is to automaticly be able to run commands on the other node in a cluster. 3.1 Generate keys on both nodes on node1 run: username@smartcard20-node1:/usr/local> sudo su - jboss jobss@smartcard20-node1:~> ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/jboss/.ssh/id_rsa): Created directory '/home/jboss/.ssh'. Enter passphrase (empty for no passphrase): (press enter to use no passphrase) Enter same passphrase again: Your identification has been saved in /home/jboss/.ssh/id_rsa. Your public key has been saved in /home/jboss/.ssh/id_rsa.pub. And also on all the other nodes run: username@smartcard20-node2:/usr/local> sudo su - jboss jobss@smartcard20-node2:~> ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/jboss/.ssh/id_rsa): Created directory '/home/jboss/.ssh'. Enter passphrase (empty for no passphrase): (press enter to use no passphrase) Enter same passphrase again: Your identification has been saved in /home/jboss/.ssh/id_rsa. Your public key has been saved in /home/jboss/.ssh/id_rsa.pub. Add the own public key to the own authorized_keys to allow local ssh jboss@smartcard20-node1:~> cp .ssh/id_rsa.pub .ssh/authorized_keys jboss@smartcard20-node1:~> ssh localhost The authenticity of host 'localhost (127.0.0.1)' can't be established. RSA key fingerprint is 73:c8:8f:20:73:83:62:c7:5e:a0:7d:cb:38:c8:04:43. Are you sure you want to continue connecting (yes/no)? yes Warning: Permanently added 'localhost' (RSA) to the list of known hosts. jboss@smartcard20-node1:~> logout on node2 run: jboss@smartcard20-node2:~> cp .ssh/id_rsa.pub .ssh/authorized_keys jboss@smartcard20-node2:~> ssh localhost The authenticity of host 'localhost (127.0.0.1)' can't be established. RSA key fingerprint is 73:c8:8f:20:73:83:62:c7:5e:a0:7d:cb:38:c8:04:43. Are you sure you want to continue connecting (yes/no)? yes Warning: Permanently added 'localhost' (RSA) to the list of known hosts. jboss@smartcard20-node2:~> logout Add node1 public key to node2 authorized_keys to allow ssh from node1 to node2 on node1 run: jboss@smartcard20-node1:~> cat .ssh/id_rsa.pub ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node1 on node2 run: jboss@smartcard20-node2:~> vi .ssh/authorized_keys ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node2 To add a new line below the only line in authorized_keys press \u201co\u201d then paste the key from node1 press escape to exit edit mode make sure that the new key is on one line only, press \u201cJ\u201d to join to lines if the line broke in copy-and-paste, delete space with \u201cx\u201d press :wq to exit Change the window size so any line-wraps problem reveals it self. Make sure each key is on one line on node2 run: jboss@smartcard20-node2:~> cat .ssh/authorized_keys ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node2 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEArzafoK1mzu0WYr1c0I8efdkOE5+58ccM83fJ32EuUxKfrvEi3GsJKyZPvuSZr4VXUgRvyyWzg8JtwJR7s+8NSqcHhdeN+zeVQx9/YCw8xOQLx9SOORato76WfwhjM7kUrZd/bIQQGRDwh1rvCVRlNr7kFFRsEe+afxP42AZkZaD6bCBsG4BF/iR5+YCERzuUymrN5g8qWU5Hw1Hegedz+7oCJZ8FO3UVB6SREDA1n4c651gWa+xtx+5KgWLcfQU8V019fzuVz45c1mF0r0zQF4Z66gq/HEkYUjttk7hgCrRaeIR1GTu+9HNF2+aSV44ZqKtd5L1cX1xsxJCJijjnSw== han@smartcard20-node1 jboss@smartcard20-node2:~> wc -l .ssh/authorized_keys 2 .ssh/authorized_keys verify ssh access to the other node: jboss@smartcard20-node1:~> ssh jboss@smartcard20-node2 Last login: Sat Jun 5 08:41:53 2010 from localhost jboss@smartcard20-node2:~> Add node2 public key to node1 authorized_keys to allow ssh from node2 to node1 on node2 run: jboss@smartcard20-node2:~> cat .ssh/id_rsa.pub ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node2 on node1 run: jboss@smartcard20-node1:~> vi .ssh/authorized_keys ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node1 To add a new line below the only line in authorized_keys press \u201co\u201d then paste the key from node2 press escape to exit edit mode make sure that the new key is on one line only, press \u201cJ\u201d to join to lines if the line broke in copy-and-paste, delete space with \u201cx\u201d press :wq to exit Change the window size so any line-wraps problem reveals it self. Make sure each key is on one line on node2 run: jboss@smartcard20-node1:~> cat .ssh/authorized_keys ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node1 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEArzafoK1mzu0WYr1c0I8efdkOE5+58ccM83fJ32EuUxKfrvEi3GsJKyZPvuSZr4VXUgRvyyWzg8JtwJR7s+8NSqcHhdeN+zeVQx9/YCw8xOQLx9SOORato76WfwhjM7kUrZd/bIQQGRDwh1rvCVRlNr7kFFRsEe+afxP42AZkZaD6bCBsG4BF/iR5+YCERzuUymrN5g8qWU5Hw1Hegedz+7oCJZ8FO3UVB6SREDA1n4c651gWa+xtx+5KgWLcfQU8V019fzuVz45c1mF0r0zQF4Z66gq/HEkYUjttk7hgCrRaeIR1GTu+9HNF2+aSV44ZqKtd5L1cX1xsxJCJijjnSw== han@smartcard20-node2 jboss@smartcard20-node2:~> wc -l .ssh/authorized_keys 2 .ssh/authorized_keys verify ssh access to the other node: jboss@smartcard20-node2:~> ssh smartcard20-node1 Last login: Sat Jun 5 08:41:53 2010 from localhost jboss@smartcard20-node1:~>","title":"SSH Keys Installation"},{"location":"syscheck-scripts/","text":"Syscheck version 2.0 \u00b6 Documentation generated: Mon 10 Aug 00:16:11 CEST 2020 Syscheck scripts \u00b6 sc_01_diskusage.sh \u00b6 Scriptid : 01 - Disk usage sc_01_diskusage . sh Script that checks for to much hard - disc usage , limit is : Error code / description - What to do 011 / Diskusage ok (% s is % s percent used : Limit is % s percent ) - No action is needed 012 / Diskusage exceeded (% s is % s percent used : Limit is % s percent ) - The usage is more than the limit , if the disk fills up thing will start to break , make some free space and maybe restart the machine 013 / Diskusage problems (%s : %s) - Manually check config and also try df -Ph / path to run with output directed to screen : add a '-s' or '--screen' sc_02_ejbca.sh \u00b6 Scriptid : 02 - EJBCA Health check sc_02_ejbca . sh Script that connects to the ejbca health check servlet to check the status of the ejbca application . The health check servlet checks JVM memory , database connection and HSM connection . Error code / description - What to do 021 / EJBCA : % s - No action is needed 022 / EJBCA : % s - Possible errors : \"Error Virtual Memory is about to run out, currently free memory : X\" - you need to add more virtual memory to application server / java process \"Error Connecting to EJBCA Database\" - The internal check of database failed , try to connect to database directly or restart database server \"CA Token is disconnected\" - activate token or maybe a restart of pcscd can help 023 / EJBCA : health check tool failure - The tool to check if EJBCA is at good health is not configured properly to run with output directed to screen : add a '-s' or '--screen' sc_03_memory-usage.sh \u00b6 Scriptid : 03 - Memory usage sc_03_memory - usage . sh Script that checks that there is enough free memory . The limit is configured in the script , limit : Error code / description - What to do 031 / Memory limit exceded ( Memory is % s KB used : Limit is % s KB ) - system currently uses more than the configured limit , this can be a warning , but can also be a sign of a hard workning system without errors 032 / Memory limit ok ( Memory is % s KB used : Limit is % s KB ) - system currently uses below the limit 033 / Swap limit exceded ( Swap is % s KB used : Limit is % s KB ) - system uses more than the swap limit and if the usage dont drop soon you need to investigate , system WILL crash if it runs out of swap compleatly 034 / Swap limit ok ( Swap is % s KB used : Limit is % s KB ) - No action is needed to run with output directed to screen : add a '-s' or '--screen' sc_04_pcsc_readers.sh \u00b6 Scriptid : 04 - Connected PCSC Readers checks for the defined number of PCSC readers is attached to the computer Error code / description - What to do 041 / Right number of attatched pcsc - readers (% s ) - No action is needed 042 / Wrong number of attached pcsc - readers current : (% s ) should be : (% s ) - means that all reader is NOT working correctly as defined by pcscd 043 / module not installed (% s ) - means that you 've not installed the module used by this script python pyscard to run with output directed to screen: add a ' - s ' or ' -- screen ' sc_05_pcscd.sh \u00b6 Scriptid : 05 - pcscd is running check that pcscd is running Error code / description - What to do 051 / pcscd is running - No action is needed 052 / pcscd is NOT running - pcscd needs to be restarted, if it dont start, run it with: /path/to/ pcscd -- foreground -- debug to run with output directed to screen : add a '-s' or '--screen' sc_06_raid_check.sh \u00b6 Scriptid : 06 - HP Raid check check the raid discs Error code / description - What to do 061 / PhysicalDiscs is OK % s - No action is needed 062 / PhysicalDiscs is not OK % s - Change disc as soon as possible 063 / LogicalDiscs is OK % s - No action is needed 064 / LogicalDiscs is rebuilding % s - check back in a while to see this error goes away , else you need to investigate 065 / LogicalDiscs has some other error % s - you need to investigate this error ASAP 066 / HPTOOL not installed at : % s - the hptool is not installed , install the tool to get working reports to run with output directed to screen : add a '-s' or '--screen' sc_07_syslog.sh \u00b6 Scriptid : 07 - Check if syslog if running check to see that syslog is running and delivers messages ok Error code / description - What to do 071 / loggmessage did not come throu SYSLOG - syslog is running but the messages dont comes throu to local file, restart and/ or check config file 072 / syslog is not running - the process was not found amoung running processes 073 / Syslog is running and delivers messages - No action is needed 074 / - to run with output directed to screen : add a '-s' or '--screen' sc_08_crl_from_webserver.sh \u00b6 Scriptid : 08 - Download CRL from Webserver and check its validity check the status of CRL , both that it can be downloaded and that its valid Error code / description - What to do 081 / CRL % s creation have failed - either the server is not up , it dont produce CRL : s , it dont validate or the CRL is old 082 / % s - No action is needed 083 / Unable to get CRL % s from webserver - Check manually to get CRL from webserver 084 / When getting CRL % s the size of file is 0 - Check discusage , try manually to get CRL 085 / Configuration error : % s - Check config 086 / CRL has past the EXPIRE date : % s - Systems will probably fail due to this , urgent troubleshooting needed 087 / CRL has past the ERROR level : % s - Systems will soon fail if not fixed , urgent troubleshooting needed 088 / CRL has past the WARN level : % s - Systems will soon fail if not fixed , urgent troubleshooting needed 089 / CRL summary problems : % s - Systems will soon fail if not fixed , urgent troubleshooting needed to run with output directed to screen : add a '-s' or '--screen' sc_09_firewall.sh \u00b6 Scriptid : 09 - Firewall iptables Check the firewall is configured and running Error code / description - What to do 091 / Cant get status from iptables . - check manually with iptables - L - n or maybe restart the firewall with / etc / init . d / firewall start 092 / Firewall doesn 't seem to have the correct ruleset configured. - Maybe something went wrong loading the firewall ruleset, because some very basic rules are' nt present 093 / Firewall is up and configured properly - No action is needed to run with output directed to screen : add a '-s' or '--screen' sc_10_ocsp.sh \u00b6 Scriptid : 10 - Query OCSP Responder all ok Error code / description - What to do 101 / Responder cert calculation failed (% s ) - either the server is not up , it don 't produce OCSP Responses:s 102 / Responder cert ok: %s minutes remains: %s - No action is needed 103 / Responder cert has passed validity warning level %s : %s - Schedule a update of Responder cert 104 / Responder cert has passed validity ERROR level %s : %s - Urgently replace the OCSP responder certificate 105 / Responder cert has PASSED EXPIRY date %s : %s - Urgently replace the OCSP responder certificate 106 / Response status ok: %s - this ocsp response is ok 107 / OCSP Summary ERROR msg: %s errors: %s warnings: %s - search for 10 in logs for more detailed info or run syscheck manually 108 / OCSP Summary WARNING msg: %s errors: %s warnings: %s - search for 10 in logs for more detailed info or run syscheck manually 109 / OCSP Summary OK - this ocsp summary is ok 1010 / OCSP response not ok %s - ocsp response not ok to run with output directed to screen: add a ' - s ' or ' -- screen ' sc_12_mysql.sh \u00b6 Scriptid : 12 - Mysql server Mysql server checks Error code / description - What to do 121 / mysql is running - No action is needed 122 / mysql is NOT running - mysql is not running, try /etc/init.d/mysql stop, wait, /etc/init.d/ mysql start to run with output directed to screen : add a '-s' or '--screen' sc_14_sw_raid.sh \u00b6 Scriptid : 14 - SW Raid Linux software raid checks Error code / description - What to do 141 / Disc Array is OK % s - means this script has not detected any errors 142 / Disc % s is failed in array : % s - A disk has failed , you need to replace it 143 / Unpredicted error in SW - raid % s - this script has found a not prediced error to run with output directed to screen : add a '-s' or '--screen' sc_15_apache.sh \u00b6 Scriptid : 15 - Apache Web server Check apache process is up and running Error code / description - What to do 151 / Apache webserver is running - server is running and serving web pages 152 / Apache webserver is not running - check apache error . log , it is not running to run with output directed to screen : add a '-s' or '--screen' sc_16_ldap.sh \u00b6 Scriptid : 16 - LDAP Server Checks the ldap server to make sure it 's running Error code / description - What to do 161 / LDAP directory server is running - all ok 162 / LDAP directory server is not running - check you ldap server logs to run with output directed to screen: add a ' - s ' or ' -- screen ' sc_17_ntp.sh \u00b6 Scriptid : 17 - NTP in sync Check that ntp i running and is insync Error code / description - What to do 171 / ntpd is in sync with server : % s - all ok 172 / ntpd is NOT running. - Start it with / etc / init.d / xntpd start 173 / cant check ntp sync to : % s - check the configuration or restart ntpd 174 / ntpd can NOT synchronize to servers LOCAL ( 0 ) mode - Check network connectivity and configuration of ntp 175 / ntp server not sent in input - Check your syscheck config for ntp to run with output directed to screen : add a '-s' or '--screen' sc_18_sqlselect.sh \u00b6 Scriptid : 18 - Mysql Select Mysql select keepalive Error code / description - What to do 181 / mysql is running and answering - No action is needed 182 / mysql is NOT answering to select statement check - mysql is not running, try /etc/init.d/mysql stop, wait, /etc/init.d/ mysql start to run with output directed to screen : add a '-s' or '--screen' sc_19_alive.sh \u00b6 Scriptid : 19 - Server is alive Sends alive messages to a central syscheck server run this script either along with the rest of the syscheck scripts or in a crontab ( then you can run me more often ...) Error code / description - What to do 191 / Operating system just started - Message is sent when the server 's operating system is started 192 / Operating system is shutting down - Message is sent when the server' s operating system is shutdown 193 / I 'm alive - Message is sent to make sure central server know' s this server is alive to run with output directed to screen : add a '-s' or '--screen' sc_20_errors_ejbcalog.sh \u00b6 Scriptid : 20 - EJBCA Error log checker checks fo new errors in the server log for ejbca Error code / description - What to do 201 / No new errors in ejbca server log - No action is needed 202 / New error in log : % s - There was new ERRORS in the LOG file , please attend to them 203 / Cant find the specified ejbca log % s - maybe you havnt configured the script yet ? 204 / New detailed error in log : % s - There was new ERRORS in the LOG file , please attend to them to run with output directed to screen : add a '-s' or '--screen' sc_22_boks_replica.sh \u00b6 Scriptid : 22 - BOKS BoKS Replica checks Error code / description - What to do 221 / No action is needed - all boks processes are running 222 / All BoKS replica processes IS NOT running % s - Not all boks processes are running to run with output directed to screen : add a '-s' or '--screen' sc_23_rsa_axm.sh \u00b6 Scriptid : 23 - RSA Access Manager Checks the RSA Access Manager server to make sure it 's running Error code / description - What to do 231 / RSA Access Manager is running - all ok 232 / At least one service is not running (%s) - check the rsa access manager server logs to run with output directed to screen: add a ' - s ' or ' -- screen ' sc_27_dss.sh \u00b6 Scriptid : 27 - SignServer checks the dss server Error code / description - What to do 271 / Document SignServer is active - No action needed 272 / Document SignServer is running at ONLY ONE NODE - Check the failing node asap 273 / Document SignServer is NOT active - resolve this issue asap 274 / Document SignServer is not installed at this host - maybe you 've configured wrong scripts or not yet installed signserver to run with output directed to screen: add a ' - s ' or ' -- screen ' sc_28_check_vip.sh \u00b6 Scriptid : 28 - VIP Checks which node has the VIP address Error code / description - What to do 281 / Node 1 has the VIP - No action needed 282 / Node 2 has the VIP - No action needed 283 / Both nodes has the VIP - Resolve this issue asap 284 / None of the nodes has the VIP - Resolve this issue asap 285 / ssh tool 915 not activated - enable 915 to run with output directed to screen : add a '-s' or '--screen' sc_29_signserver.sh \u00b6 Scriptid : 29 - SignServer health checker signserver Script that connects to the signserver health check servlet to check the status of the signserver application . The health check servlet checks JVM memory , database connection and HSM connection . Error code / description - What to do 291 / SIGNSERVER : % s - No action is needed 292 / SIGNSERVER : % s - Possible errors : \"Error Virtual Memory is about to run out, currently free memory : X\" - you need to add more virtual memory to application server / java process \"Error Connecting to SIGNSERVER Database\" - The internal check of database failed , try to connect to database directly or restart database server \"CA Token is disconnected\" - activate token or maybe a restart of pcscd can help 293 / SIGNSERVER : Application Server is unavailable - The server is non-responding, restart application-server (jboss) and/ or check server log to find the fault to run with output directed to screen : add a '-s' or '--screen' sc_30_check_running_procs.sh \u00b6 Scriptid : 30 - Running processes Generic script to check a proc is running and try to restart those that 's not Error code / description - What to do 301 / Process %s is running - No action is needed 302 / Process %s was not running, restart succeded - If this happens regulary this need to be looked into 303 / Process %s was not running, restart failed - If this needs to be this handled manually to run with output directed to screen: add a ' - s ' or ' -- screen ' sc_31_hp_health.sh \u00b6 Scriptid : 31 - HP Server health check Check the HP Server health Error code / description - What to do 311 / Sensor of % s is OK % s - No action is needed 312 / Temp sensor % s is NOT OK % s - Run manual test with hpasmcli 313 / FAN sensor % s is NOT OK % s - Run manual test with hpasmcli 314 / Tool not found : % s - Install or set path to run with output directed to screen : add a '-s' or '--screen' sc_32_check_db_sync.sh \u00b6 Scriptid : 32 - EJBCA DB Sync Check if DB in sync Error code / description - What to do 321 / DB in sync - and updating databases 322 / DB not in sync , date of CertificateData diff betwin nodes : - check error . log , probebly needing manual sync , se manual to run with output directed to screen : add a '-s' or '--screen' sc_33_healthchecker.sh \u00b6 Scriptid : 33 - Check Health of applications Healthcheck of applications with simple URL health ( should return ALLOK and status 200 ) Error code / description - What to do 331 / app : % s ok - No action is needed 332 / app : % s NOT ok error message : % s - Check errormessage and log - file 333 / app : % s CHECKTOOL not curl nor wget - Config curl or wget 334 / app : % s restarting due to previous failure status : % s command : % s restarts in last 24 h : % s - Check errormessage and log - file 335 / app : % s NOT restarting due to to many restarts in last 24 h : % s - Check errormessage and log - file 336 / app : % s , MAXRESTARTS not set - Config in the config file to run with output directed to screen : add a '-s' or '--screen' sc_34_redis.sh \u00b6 Scriptid : 34 - Redis Check Redis VIP Error code / description - What to do 341 / server is OK at % s :% s (% s ) - All is ok 342 / server is not responding % s :% s (% s ) - check the redis server is not responding 343 / Input Arg problem % s - Check config 344 / redis-cli is not found - install/ configure redis - cli in config to run with output directed to screen : add a '-s' or '--screen' sc_35_dell_raid.sh \u00b6 Scriptid : 35 - Dell Hard drive checker check the raid discs Error code / description - What to do 351 / PhysicalDiscs is OK % s - No action is needed 352 / PhysicalDiscs is not OK % s - Change disc as soon as possible 353 / LogicalDiscs is OK % s - No action is needed 354 / LogicalDiscs is rebuilding % s - check back in a while to see this error goes away , else you need to investigate 355 / LogicalDiscs has some other error % s - you need to investigate this error ASAP 356 / TOOL not installed at : % s - the tool is not installed , install the tool to get working reports to run with output directed to screen : add a '-s' or '--screen' sc_36_dell_health.sh \u00b6 Scriptid : 36 - Dell Server system components check dell system components Error code / description - What to do 361 / Component is OK % s - No action is needed 362 / Component NOT OK % s - Change component as soon as possible 363 / TOOL not installed at : % s - the tool is not installed , install the tool to get working reports to run with output directed to screen : add a '-s' or '--screen' sc_37_monitor_jnlp.sh \u00b6 Scriptid : 37 - Get remote URL and check status sc_37_monitor_internal_error . sh Error code / description - What to do 371 / ok : % s - No action is needed 372 / problem : % s - problem found when getting the URL : % s 373 / Can not find CURL tool: %s - Install/ configure curl to run with output directed to screen : add a '-s' or '--screen'","title":"All Syscheck scripts"},{"location":"syscheck-scripts/#syscheck-version-20","text":"Documentation generated: Mon 10 Aug 00:16:11 CEST 2020","title":"Syscheck version 2.0"},{"location":"syscheck-scripts/#syscheck-scripts","text":"","title":"Syscheck scripts"},{"location":"syscheck-scripts/#sc_01_diskusagesh","text":"Scriptid : 01 - Disk usage sc_01_diskusage . sh Script that checks for to much hard - disc usage , limit is : Error code / description - What to do 011 / Diskusage ok (% s is % s percent used : Limit is % s percent ) - No action is needed 012 / Diskusage exceeded (% s is % s percent used : Limit is % s percent ) - The usage is more than the limit , if the disk fills up thing will start to break , make some free space and maybe restart the machine 013 / Diskusage problems (%s : %s) - Manually check config and also try df -Ph / path to run with output directed to screen : add a '-s' or '--screen'","title":"sc_01_diskusage.sh"},{"location":"syscheck-scripts/#sc_02_ejbcash","text":"Scriptid : 02 - EJBCA Health check sc_02_ejbca . sh Script that connects to the ejbca health check servlet to check the status of the ejbca application . The health check servlet checks JVM memory , database connection and HSM connection . Error code / description - What to do 021 / EJBCA : % s - No action is needed 022 / EJBCA : % s - Possible errors : \"Error Virtual Memory is about to run out, currently free memory : X\" - you need to add more virtual memory to application server / java process \"Error Connecting to EJBCA Database\" - The internal check of database failed , try to connect to database directly or restart database server \"CA Token is disconnected\" - activate token or maybe a restart of pcscd can help 023 / EJBCA : health check tool failure - The tool to check if EJBCA is at good health is not configured properly to run with output directed to screen : add a '-s' or '--screen'","title":"sc_02_ejbca.sh"},{"location":"syscheck-scripts/#sc_03_memory-usagesh","text":"Scriptid : 03 - Memory usage sc_03_memory - usage . sh Script that checks that there is enough free memory . The limit is configured in the script , limit : Error code / description - What to do 031 / Memory limit exceded ( Memory is % s KB used : Limit is % s KB ) - system currently uses more than the configured limit , this can be a warning , but can also be a sign of a hard workning system without errors 032 / Memory limit ok ( Memory is % s KB used : Limit is % s KB ) - system currently uses below the limit 033 / Swap limit exceded ( Swap is % s KB used : Limit is % s KB ) - system uses more than the swap limit and if the usage dont drop soon you need to investigate , system WILL crash if it runs out of swap compleatly 034 / Swap limit ok ( Swap is % s KB used : Limit is % s KB ) - No action is needed to run with output directed to screen : add a '-s' or '--screen'","title":"sc_03_memory-usage.sh"},{"location":"syscheck-scripts/#sc_04_pcsc_readerssh","text":"Scriptid : 04 - Connected PCSC Readers checks for the defined number of PCSC readers is attached to the computer Error code / description - What to do 041 / Right number of attatched pcsc - readers (% s ) - No action is needed 042 / Wrong number of attached pcsc - readers current : (% s ) should be : (% s ) - means that all reader is NOT working correctly as defined by pcscd 043 / module not installed (% s ) - means that you 've not installed the module used by this script python pyscard to run with output directed to screen: add a ' - s ' or ' -- screen '","title":"sc_04_pcsc_readers.sh"},{"location":"syscheck-scripts/#sc_05_pcscdsh","text":"Scriptid : 05 - pcscd is running check that pcscd is running Error code / description - What to do 051 / pcscd is running - No action is needed 052 / pcscd is NOT running - pcscd needs to be restarted, if it dont start, run it with: /path/to/ pcscd -- foreground -- debug to run with output directed to screen : add a '-s' or '--screen'","title":"sc_05_pcscd.sh"},{"location":"syscheck-scripts/#sc_06_raid_checksh","text":"Scriptid : 06 - HP Raid check check the raid discs Error code / description - What to do 061 / PhysicalDiscs is OK % s - No action is needed 062 / PhysicalDiscs is not OK % s - Change disc as soon as possible 063 / LogicalDiscs is OK % s - No action is needed 064 / LogicalDiscs is rebuilding % s - check back in a while to see this error goes away , else you need to investigate 065 / LogicalDiscs has some other error % s - you need to investigate this error ASAP 066 / HPTOOL not installed at : % s - the hptool is not installed , install the tool to get working reports to run with output directed to screen : add a '-s' or '--screen'","title":"sc_06_raid_check.sh"},{"location":"syscheck-scripts/#sc_07_syslogsh","text":"Scriptid : 07 - Check if syslog if running check to see that syslog is running and delivers messages ok Error code / description - What to do 071 / loggmessage did not come throu SYSLOG - syslog is running but the messages dont comes throu to local file, restart and/ or check config file 072 / syslog is not running - the process was not found amoung running processes 073 / Syslog is running and delivers messages - No action is needed 074 / - to run with output directed to screen : add a '-s' or '--screen'","title":"sc_07_syslog.sh"},{"location":"syscheck-scripts/#sc_08_crl_from_webserversh","text":"Scriptid : 08 - Download CRL from Webserver and check its validity check the status of CRL , both that it can be downloaded and that its valid Error code / description - What to do 081 / CRL % s creation have failed - either the server is not up , it dont produce CRL : s , it dont validate or the CRL is old 082 / % s - No action is needed 083 / Unable to get CRL % s from webserver - Check manually to get CRL from webserver 084 / When getting CRL % s the size of file is 0 - Check discusage , try manually to get CRL 085 / Configuration error : % s - Check config 086 / CRL has past the EXPIRE date : % s - Systems will probably fail due to this , urgent troubleshooting needed 087 / CRL has past the ERROR level : % s - Systems will soon fail if not fixed , urgent troubleshooting needed 088 / CRL has past the WARN level : % s - Systems will soon fail if not fixed , urgent troubleshooting needed 089 / CRL summary problems : % s - Systems will soon fail if not fixed , urgent troubleshooting needed to run with output directed to screen : add a '-s' or '--screen'","title":"sc_08_crl_from_webserver.sh"},{"location":"syscheck-scripts/#sc_09_firewallsh","text":"Scriptid : 09 - Firewall iptables Check the firewall is configured and running Error code / description - What to do 091 / Cant get status from iptables . - check manually with iptables - L - n or maybe restart the firewall with / etc / init . d / firewall start 092 / Firewall doesn 't seem to have the correct ruleset configured. - Maybe something went wrong loading the firewall ruleset, because some very basic rules are' nt present 093 / Firewall is up and configured properly - No action is needed to run with output directed to screen : add a '-s' or '--screen'","title":"sc_09_firewall.sh"},{"location":"syscheck-scripts/#sc_10_ocspsh","text":"Scriptid : 10 - Query OCSP Responder all ok Error code / description - What to do 101 / Responder cert calculation failed (% s ) - either the server is not up , it don 't produce OCSP Responses:s 102 / Responder cert ok: %s minutes remains: %s - No action is needed 103 / Responder cert has passed validity warning level %s : %s - Schedule a update of Responder cert 104 / Responder cert has passed validity ERROR level %s : %s - Urgently replace the OCSP responder certificate 105 / Responder cert has PASSED EXPIRY date %s : %s - Urgently replace the OCSP responder certificate 106 / Response status ok: %s - this ocsp response is ok 107 / OCSP Summary ERROR msg: %s errors: %s warnings: %s - search for 10 in logs for more detailed info or run syscheck manually 108 / OCSP Summary WARNING msg: %s errors: %s warnings: %s - search for 10 in logs for more detailed info or run syscheck manually 109 / OCSP Summary OK - this ocsp summary is ok 1010 / OCSP response not ok %s - ocsp response not ok to run with output directed to screen: add a ' - s ' or ' -- screen '","title":"sc_10_ocsp.sh"},{"location":"syscheck-scripts/#sc_12_mysqlsh","text":"Scriptid : 12 - Mysql server Mysql server checks Error code / description - What to do 121 / mysql is running - No action is needed 122 / mysql is NOT running - mysql is not running, try /etc/init.d/mysql stop, wait, /etc/init.d/ mysql start to run with output directed to screen : add a '-s' or '--screen'","title":"sc_12_mysql.sh"},{"location":"syscheck-scripts/#sc_14_sw_raidsh","text":"Scriptid : 14 - SW Raid Linux software raid checks Error code / description - What to do 141 / Disc Array is OK % s - means this script has not detected any errors 142 / Disc % s is failed in array : % s - A disk has failed , you need to replace it 143 / Unpredicted error in SW - raid % s - this script has found a not prediced error to run with output directed to screen : add a '-s' or '--screen'","title":"sc_14_sw_raid.sh"},{"location":"syscheck-scripts/#sc_15_apachesh","text":"Scriptid : 15 - Apache Web server Check apache process is up and running Error code / description - What to do 151 / Apache webserver is running - server is running and serving web pages 152 / Apache webserver is not running - check apache error . log , it is not running to run with output directed to screen : add a '-s' or '--screen'","title":"sc_15_apache.sh"},{"location":"syscheck-scripts/#sc_16_ldapsh","text":"Scriptid : 16 - LDAP Server Checks the ldap server to make sure it 's running Error code / description - What to do 161 / LDAP directory server is running - all ok 162 / LDAP directory server is not running - check you ldap server logs to run with output directed to screen: add a ' - s ' or ' -- screen '","title":"sc_16_ldap.sh"},{"location":"syscheck-scripts/#sc_17_ntpsh","text":"Scriptid : 17 - NTP in sync Check that ntp i running and is insync Error code / description - What to do 171 / ntpd is in sync with server : % s - all ok 172 / ntpd is NOT running. - Start it with / etc / init.d / xntpd start 173 / cant check ntp sync to : % s - check the configuration or restart ntpd 174 / ntpd can NOT synchronize to servers LOCAL ( 0 ) mode - Check network connectivity and configuration of ntp 175 / ntp server not sent in input - Check your syscheck config for ntp to run with output directed to screen : add a '-s' or '--screen'","title":"sc_17_ntp.sh"},{"location":"syscheck-scripts/#sc_18_sqlselectsh","text":"Scriptid : 18 - Mysql Select Mysql select keepalive Error code / description - What to do 181 / mysql is running and answering - No action is needed 182 / mysql is NOT answering to select statement check - mysql is not running, try /etc/init.d/mysql stop, wait, /etc/init.d/ mysql start to run with output directed to screen : add a '-s' or '--screen'","title":"sc_18_sqlselect.sh"},{"location":"syscheck-scripts/#sc_19_alivesh","text":"Scriptid : 19 - Server is alive Sends alive messages to a central syscheck server run this script either along with the rest of the syscheck scripts or in a crontab ( then you can run me more often ...) Error code / description - What to do 191 / Operating system just started - Message is sent when the server 's operating system is started 192 / Operating system is shutting down - Message is sent when the server' s operating system is shutdown 193 / I 'm alive - Message is sent to make sure central server know' s this server is alive to run with output directed to screen : add a '-s' or '--screen'","title":"sc_19_alive.sh"},{"location":"syscheck-scripts/#sc_20_errors_ejbcalogsh","text":"Scriptid : 20 - EJBCA Error log checker checks fo new errors in the server log for ejbca Error code / description - What to do 201 / No new errors in ejbca server log - No action is needed 202 / New error in log : % s - There was new ERRORS in the LOG file , please attend to them 203 / Cant find the specified ejbca log % s - maybe you havnt configured the script yet ? 204 / New detailed error in log : % s - There was new ERRORS in the LOG file , please attend to them to run with output directed to screen : add a '-s' or '--screen'","title":"sc_20_errors_ejbcalog.sh"},{"location":"syscheck-scripts/#sc_22_boks_replicash","text":"Scriptid : 22 - BOKS BoKS Replica checks Error code / description - What to do 221 / No action is needed - all boks processes are running 222 / All BoKS replica processes IS NOT running % s - Not all boks processes are running to run with output directed to screen : add a '-s' or '--screen'","title":"sc_22_boks_replica.sh"},{"location":"syscheck-scripts/#sc_23_rsa_axmsh","text":"Scriptid : 23 - RSA Access Manager Checks the RSA Access Manager server to make sure it 's running Error code / description - What to do 231 / RSA Access Manager is running - all ok 232 / At least one service is not running (%s) - check the rsa access manager server logs to run with output directed to screen: add a ' - s ' or ' -- screen '","title":"sc_23_rsa_axm.sh"},{"location":"syscheck-scripts/#sc_27_dsssh","text":"Scriptid : 27 - SignServer checks the dss server Error code / description - What to do 271 / Document SignServer is active - No action needed 272 / Document SignServer is running at ONLY ONE NODE - Check the failing node asap 273 / Document SignServer is NOT active - resolve this issue asap 274 / Document SignServer is not installed at this host - maybe you 've configured wrong scripts or not yet installed signserver to run with output directed to screen: add a ' - s ' or ' -- screen '","title":"sc_27_dss.sh"},{"location":"syscheck-scripts/#sc_28_check_vipsh","text":"Scriptid : 28 - VIP Checks which node has the VIP address Error code / description - What to do 281 / Node 1 has the VIP - No action needed 282 / Node 2 has the VIP - No action needed 283 / Both nodes has the VIP - Resolve this issue asap 284 / None of the nodes has the VIP - Resolve this issue asap 285 / ssh tool 915 not activated - enable 915 to run with output directed to screen : add a '-s' or '--screen'","title":"sc_28_check_vip.sh"},{"location":"syscheck-scripts/#sc_29_signserversh","text":"Scriptid : 29 - SignServer health checker signserver Script that connects to the signserver health check servlet to check the status of the signserver application . The health check servlet checks JVM memory , database connection and HSM connection . Error code / description - What to do 291 / SIGNSERVER : % s - No action is needed 292 / SIGNSERVER : % s - Possible errors : \"Error Virtual Memory is about to run out, currently free memory : X\" - you need to add more virtual memory to application server / java process \"Error Connecting to SIGNSERVER Database\" - The internal check of database failed , try to connect to database directly or restart database server \"CA Token is disconnected\" - activate token or maybe a restart of pcscd can help 293 / SIGNSERVER : Application Server is unavailable - The server is non-responding, restart application-server (jboss) and/ or check server log to find the fault to run with output directed to screen : add a '-s' or '--screen'","title":"sc_29_signserver.sh"},{"location":"syscheck-scripts/#sc_30_check_running_procssh","text":"Scriptid : 30 - Running processes Generic script to check a proc is running and try to restart those that 's not Error code / description - What to do 301 / Process %s is running - No action is needed 302 / Process %s was not running, restart succeded - If this happens regulary this need to be looked into 303 / Process %s was not running, restart failed - If this needs to be this handled manually to run with output directed to screen: add a ' - s ' or ' -- screen '","title":"sc_30_check_running_procs.sh"},{"location":"syscheck-scripts/#sc_31_hp_healthsh","text":"Scriptid : 31 - HP Server health check Check the HP Server health Error code / description - What to do 311 / Sensor of % s is OK % s - No action is needed 312 / Temp sensor % s is NOT OK % s - Run manual test with hpasmcli 313 / FAN sensor % s is NOT OK % s - Run manual test with hpasmcli 314 / Tool not found : % s - Install or set path to run with output directed to screen : add a '-s' or '--screen'","title":"sc_31_hp_health.sh"},{"location":"syscheck-scripts/#sc_32_check_db_syncsh","text":"Scriptid : 32 - EJBCA DB Sync Check if DB in sync Error code / description - What to do 321 / DB in sync - and updating databases 322 / DB not in sync , date of CertificateData diff betwin nodes : - check error . log , probebly needing manual sync , se manual to run with output directed to screen : add a '-s' or '--screen'","title":"sc_32_check_db_sync.sh"},{"location":"syscheck-scripts/#sc_33_healthcheckersh","text":"Scriptid : 33 - Check Health of applications Healthcheck of applications with simple URL health ( should return ALLOK and status 200 ) Error code / description - What to do 331 / app : % s ok - No action is needed 332 / app : % s NOT ok error message : % s - Check errormessage and log - file 333 / app : % s CHECKTOOL not curl nor wget - Config curl or wget 334 / app : % s restarting due to previous failure status : % s command : % s restarts in last 24 h : % s - Check errormessage and log - file 335 / app : % s NOT restarting due to to many restarts in last 24 h : % s - Check errormessage and log - file 336 / app : % s , MAXRESTARTS not set - Config in the config file to run with output directed to screen : add a '-s' or '--screen'","title":"sc_33_healthchecker.sh"},{"location":"syscheck-scripts/#sc_34_redissh","text":"Scriptid : 34 - Redis Check Redis VIP Error code / description - What to do 341 / server is OK at % s :% s (% s ) - All is ok 342 / server is not responding % s :% s (% s ) - check the redis server is not responding 343 / Input Arg problem % s - Check config 344 / redis-cli is not found - install/ configure redis - cli in config to run with output directed to screen : add a '-s' or '--screen'","title":"sc_34_redis.sh"},{"location":"syscheck-scripts/#sc_35_dell_raidsh","text":"Scriptid : 35 - Dell Hard drive checker check the raid discs Error code / description - What to do 351 / PhysicalDiscs is OK % s - No action is needed 352 / PhysicalDiscs is not OK % s - Change disc as soon as possible 353 / LogicalDiscs is OK % s - No action is needed 354 / LogicalDiscs is rebuilding % s - check back in a while to see this error goes away , else you need to investigate 355 / LogicalDiscs has some other error % s - you need to investigate this error ASAP 356 / TOOL not installed at : % s - the tool is not installed , install the tool to get working reports to run with output directed to screen : add a '-s' or '--screen'","title":"sc_35_dell_raid.sh"},{"location":"syscheck-scripts/#sc_36_dell_healthsh","text":"Scriptid : 36 - Dell Server system components check dell system components Error code / description - What to do 361 / Component is OK % s - No action is needed 362 / Component NOT OK % s - Change component as soon as possible 363 / TOOL not installed at : % s - the tool is not installed , install the tool to get working reports to run with output directed to screen : add a '-s' or '--screen'","title":"sc_36_dell_health.sh"},{"location":"syscheck-scripts/#sc_37_monitor_jnlpsh","text":"Scriptid : 37 - Get remote URL and check status sc_37_monitor_internal_error . sh Error code / description - What to do 371 / ok : % s - No action is needed 372 / problem : % s - problem found when getting the URL : % s 373 / Can not find CURL tool: %s - Install/ configure curl to run with output directed to screen : add a '-s' or '--screen'","title":"sc_37_monitor_jnlp.sh"},{"location":"upgrade/","text":"","title":"upgrade"}]}